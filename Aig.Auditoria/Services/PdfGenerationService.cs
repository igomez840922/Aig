using DataAccess;
using DataModel;
using DataModel.Helper;
using DocumentFormat.OpenXml.InkML;
using QuestPDF.Fluent;
using QuestPDF.Helpers;
using QuestPDF.Infrastructure;

namespace Aig.Auditoria.Services
{
    public class PdfGenerationService : IPdfGenerationService
    {
        private readonly IDalService DalService;
        private readonly IWebHostEnvironment env;
        private TextStyle cellTextStyle;

        public PdfGenerationService(IDalService dalService, IWebHostEnvironment env)
        {
            DalService = dalService;
            this.env = env;
            cellTextStyle = TextStyle.Default.FontColor("#FFFFFF");
        }

        public async Task<Stream> GenerateInspectionPDF(long InspectionId)
        {
            try
            {
                var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);
                switch (inspection.TipoActa)
                {
                    case DataModel.Helper.enumAUD_TipoActa.RR:
                        {
                            return await GenerateRetentionReceptionPDF(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.AF:
                    case DataModel.Helper.enumAUD_TipoActa.CUF:
                        {
                            inspection.InspAperCambUbicFarm.DatosSolicitante = inspection.InspAperCambUbicFarm.DatosSolicitante != null ? inspection.InspAperCambUbicFarm.DatosSolicitante : new AUD_DatosSolicitante();

                            return await GenerateAperturaCambioUbicacionFarmacia(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.AA:
                    case DataModel.Helper.enumAUD_TipoActa.CUA:
                        {
                            inspection.InspAperCambUbicAgen.DatosSolicitante = inspection.InspAperCambUbicAgen.DatosSolicitante != null ? inspection.InspAperCambUbicAgen.DatosSolicitante : new AUD_DatosSolicitante();

                            return await GenerateAperturaCambioUbicacionAgencia(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.INV:
                        {                            
                            return await GenerateInvestigaciones(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.AFM:
                        {                            
                            return await GenerateAperturaFabricantesMedicamentos(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.AFC:
                        {                            
                            return await GenerateAperturaFabricantesCosmeticoDesinfectantes(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.BPMCD:
                        {
                            
                            return await GenerateGuiaFabricantesCosmeticosDesinfectantes(inspection);
                        }
                    case DataModel.Helper.enumAUD_TipoActa.AECA:
                        {
                            return await GenerateAperturaCosmeticosArtesanales(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.BPMMN:
                        {
                            return await GenerateGuiaFabricantesProdNaturalesMedicinales(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.VF:
                        {
                            return await GenerateRutinaVigilanciaFarmacias(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.VA:
                        {
                            return await GenerateRutinaVigilanciaAgencia(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.COP:
                        {
                            return await GenerateCierreOperaciones(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.DFP:
                        {
                            return await GenerateDisposicionFinalProd(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.BPMFM:
                        {
                            return await GenerateGuiaFabricantesMedicamentos(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.BPMAM:
                        {
                            return await GenerateGuiaLabAcondicionadores(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.BPA:
                        {
                            return await GenerateGuiaBPM_BPA(inspection);
                            break;
                        }
                    case DataModel.Helper.enumAUD_TipoActa.ABP:
                    case DataModel.Helper.enumAUD_TipoActa.CUBP:
                        {
                            return await GenerateGuiaBPM_BPA(inspection);
                            break;
                        }
                }
            }
            catch { }
            return null;
        }

        // 1 - generamos el pdf del Acta de Apertura o Cambio de Ubicacion de Farmacia
        private async Task<Stream> GenerateAperturaCambioUbicacionFarmacia(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));
                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE INSPECCIONES\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column =>
                        {
                            column.Item().AlignCenter().Text("GUíA PARA LA VERIFICACIÓN DE LOS REQUISITOS ESTRUCTURALES DE APERTURA O MODIFICACIÓN POR CAMBIO DE UBICACIÓN DE FARMACIA".ToUpper()).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            column.Item().AlignLeft().Text(string.Format("No. Recibo: {0}", inspection.DatosEstablecimiento.ReciboPago));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)0.3);
                                    columns.RelativeColumn((float)0.7);
                                });

                                table.Header(header =>
                                {                                    
                                    header.Cell().DefaultTextStyle(cellTextStyle);
                                    header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Padding(3).Text("GENERALIDADES DE LA FARMACIA Y SOLICITANTE").Bold();
                                });

                                //Establecimiento
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DEL ESTABLECIMIENTO");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Nombre);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Provincia?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Distrito?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Corregimiento?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Direccion);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Telefono));
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DE SOLICITANTE");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Nombre);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Tipo");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspAperCambUbicFarm.DatosSolicitante.Tipo));
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nacionalidad");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Nacionalidad);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Cedula);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Email);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.PaisResidencia);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Provincia);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Distrito);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Corregimiento);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Direccion);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspAperCambUbicFarm.DatosSolicitante?.TelefonoResid, inspection.InspAperCambUbicFarm.DatosSolicitante?.TelefonoMovil));
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Profesión");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosSolicitante?.Profesion);

                                table.Footer(footer =>
                                {
                                    footer.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ley 66 de 10 de noviembre de 1947. Código Sanitario de la República de Panamá. (G.O. 10467 de 6 de diciembre de 1947). Artículo 200. Prohíbese ejercer conjuntamente las profesiones de médico-cirujano y farmacéutico. A partir de la aprobación de este código, ningún médico que ejerza la profesión podrá ser dueño por sí mismo o por interpuesta persona, accionista o tener participación comercial cualquiera en establecimientos en que se fabriquen, preparen o vendan medicinas y artículos de cualquier clase que se usen para la prevención o curación de enfermedades, corrección de defectos o para el diagnóstico");
                                });
                            });

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)0.3);
                                    columns.RelativeColumn((float)0.7);
                                });

                                table.Header(header =>
                                {
                                    header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("DATOS SOBRE EL REGENTE FARMACÉUTICO DE LA EMPRESA").Bold();
                                });

                                //Establecimiento
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Nombre);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Registro de Idoneidad");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.NumRegistro);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Cedula);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Email);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.PaisResidencia);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Provincia);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Distrito);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Corregimiento);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicFarm.DatosRegente?.Ubicacion);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspAperCambUbicFarm.DatosRegente?.TelefonoOfic, inspection.InspAperCambUbicFarm.DatosRegente?.TelefonoMovil));

                            });

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Estructura Organizativa de la Farmacia".ToUpper())).Bold();
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)1);
                                    columns.RelativeColumn((float)3);
                                    columns.RelativeColumn((float)4);
                                });
                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("RESPUESTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                });
                                if (inspection.InspAperCambUbicFarm?.DatosEstructuraOrganizacional?.LContenido?.Count > 0)
                                {
                                    foreach (var dat in inspection.InspAperCambUbicFarm.DatosEstructuraOrganizacional.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }

                                }
                            });

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Infraestructura de Farmacia".ToUpper())).Bold();
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)1);
                                    columns.RelativeColumn((float)3);
                                    columns.RelativeColumn((float)4);
                                });
                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("RESPUESTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                });
                                if (inspection.InspAperCambUbicFarm?.DatosInfraEstructura?.LContenido?.Count > 0)
                                {
                                    foreach (var dat in inspection.InspAperCambUbicFarm.DatosInfraEstructura.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }

                                }
                            });

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Área Física de Farmacia".ToUpper())).Bold();
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)1);
                                    columns.RelativeColumn((float)3);
                                    columns.RelativeColumn((float)4);
                                });
                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("RESPUESTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                });
                                if (inspection.InspAperCambUbicFarm?.DatosAreaFisica?.LContenido?.Count > 0)
                                {
                                    foreach (var dat in inspection.InspAperCambUbicFarm.DatosAreaFisica.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }

                                }
                            });

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Preguntas".ToUpper())).Bold();
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)1);
                                    columns.RelativeColumn((float)3);
                                    columns.RelativeColumn((float)4);
                                });
                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("RESPUESTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                });
                                if (inspection.InspAperCambUbicFarm?.DatosPreguntasGenericas?.LContenido?.Count > 0)
                                {
                                    foreach (var dat in inspection.InspAperCambUbicFarm.DatosPreguntasGenericas.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }

                                }
                            });

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Área de Productos Controlados".ToUpper())).Bold();
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)1);
                                    columns.RelativeColumn((float)3);
                                    columns.RelativeColumn((float)4);
                                });
                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("RESPUESTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                });
                                if (inspection.InspAperCambUbicFarm?.DatosAreaProductosControlados?.LContenido?.Count > 0)
                                {
                                    foreach (var dat in inspection.InspAperCambUbicFarm.DatosAreaProductosControlados.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }

                                }
                            });

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Área de Almacen de Medicamentos y otros productos para la salud humana".ToUpper())).Bold();
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)1);
                                    columns.RelativeColumn((float)3);
                                    columns.RelativeColumn((float)4);
                                });
                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("RESPUESTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                });
                                if (inspection.InspAperCambUbicFarm?.DatosAreaAlmacenamiento?.LContenido?.Count > 0)
                                {
                                    foreach (var dat in inspection.InspAperCambUbicFarm.DatosAreaAlmacenamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }

                                }
                            });

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONES GENERALES").Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            if (inspection.DatosConclusiones != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn();
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEGÚN CRITERIO TÉCNICO SE CONCLUYE QUE").Bold();
                                    });

                                    if (inspection.DatosConclusiones.CumpleRequisitosMinOperacion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }
                                    else
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL NO CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }

                                });
                            }

                            column.Item().PaddingVertical(5).Text("OBSERVACIÓN:").Bold();
                            column.Item().Text("El Acta original se mantendrá en el expediente del establecimiento que permanece en la Dirección Nacional de Farmacia y Drogas y se hace entrega de una copia al firmante de esta acta, al finalizar la inspección").Bold();

                            column.Item().PaddingVertical(5).Text("DE NO CUMPLIR CON LOS REQUISITOS MÍNIMOS ESTRUCTURALES EN ESTA ACTA, EL USUARIO DEBERÁ SUBSANAR TODOS LOS PUNTOS PENDIENTES, PARA SU DEBIDA VERIFICACIÓN EN UNA SEGUNDA INSPECCIÓN. SI EN ESTA SEGUNDA INPECCIÓN REINCIDE EN LAS DESVIACIONES IDENTIFICADAS EN LA PRIMERA INSPECCIÓN, SE PROCEDERÁ A LA DEVOLUCIÓN DE LA SOLICITUD Y EL INTERESADO DEBERÁ REINICIAR EL TRÁMITE CON TODOS LOS REQUISITOS ESTABLECIDOS PARA EL MISMO").Bold();


                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspAperCambUbicFarm.DatosSolicitante?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperCambUbicFarm.DatosSolicitante.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspAperCambUbicFarm.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperCambUbicFarm.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspAperCambUbicFarm.DatosSolicitante?.Nombre, inspection.InspAperCambUbicFarm.DatosSolicitante?.Cedula, inspection.InspAperCambUbicFarm.DatosSolicitante?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspAperCambUbicFarm.DatosRegente?.Nombre, inspection.InspAperCambUbicFarm.DatosRegente?.Cedula, inspection.InspAperCambUbicFarm.DatosRegente?.Cargo, inspection.InspAperCambUbicFarm.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));


                            column.Item().AlignBottom().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                        header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold();
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                    tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                                table.Cell().ColumnSpan(2).AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                            });

                        });

                        //page.Footer().ShowOnce().Table(table =>
                        //{
                        //    table.ColumnsDefinition(columns =>
                        //    {
                        //        columns.RelativeColumn();
                        //    });

                        //    table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        //});
                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch(Exception ex)
            { }
            return null;
        }
        //2 - generamos el pdf del Acta de Apertura o Cambio de Ubicacion de Agencia
        private async Task<Stream> GenerateAperturaCambioUbicacionAgencia(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));
                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE INSPECCIONES\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("GUíA PARA LA VERIFICACIÓN DE LOS REQUISITOS ESTRUCTURALES DE APERTURA O MODIFICACIÓN POR CAMBIO DE UBICACIÓN DE AGENCIA DISTRIBUIDORA".ToUpper()).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");


                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            column.Item().AlignLeft().Text(string.Format("No. Recibo: {0}", inspection.DatosEstablecimiento.ReciboPago));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            if (inspection.DatosEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("GENERALIDADES DEL ESTABLECIMIENTO Y SOLICITANTE").Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DEL ESTABLECIMIENTO");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Provincia?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Distrito?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Corregimiento?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Direccion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.Telefono));

                                    if (inspection.InspAperCambUbicAgen.DatosSolicitante != null)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DE SOLICITANTE");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Tipo");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspAperCambUbicAgen.DatosSolicitante.Tipo));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nacionalidad");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante.Nacionalidad);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante.Cedula);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante.Email);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante?.PaisResidencia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante?.Provincia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante?.Distrito);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante?.Corregimiento);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante?.Direccion);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspAperCambUbicAgen.DatosSolicitante.TelefonoResid, inspection.InspAperCambUbicAgen.DatosSolicitante.TelefonoMovil));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Profesión");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosSolicitante.Profesion);
                                    }

                                    table.Footer(footer =>
                                    {
                                        footer.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ley 66 de 10 de noviembre de 1947. Código Sanitario de la República de Panamá. (G.O. 10467 de 6 de diciembre de 1947). Artículo 200. Prohíbese ejercer conjuntamente las profesiones de médico-cirujano y farmacéutico. A partir de la aprobación de este código, ningún médico que ejerza la profesión podrá ser dueño por sí mismo o por interpuesta persona, accionista o tener participación comercial cualquiera en establecimientos en que se fabriquen, preparen o vendan medicinas y artículos de cualquier clase que se usen para la prevención o curación de enfermedades, corrección de defectos o para el diagnóstico");
                                    });
                                });

                            }

                            if (inspection.InspAperCambUbicAgen.DatosRegente != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("DATOS SOBRE EL REGENTE FARMACÉUTICO DE LA EMPRESA").Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Registro de Idoneidad");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente.NumRegistro);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente.Cedula);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente.Email);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente?.PaisResidencia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente?.Provincia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente?.Distrito);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente?.Corregimiento);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicAgen.DatosRegente?.Ubicacion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspAperCambUbicAgen.DatosRegente.TelefonoOfic, inspection.InspAperCambUbicAgen.DatosRegente?.TelefonoMovil));

                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Se encontraba presente al momento de la inspección");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspAperCambUbicAgen.DatosRegente.PresenteEnInspeccion));

                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("El Regente Farmacéutico realiza otras funciones del dentro de la empresa?");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspAperCambUbicAgen.DatosRegente.RealizaOtraFuncion));
                                });

                            }

                            if (inspection.InspAperCambUbicAgen.CondCaractEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CONDICIONES Y CARACTERÍSTICAS DEL ESTABLECIMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.CondCaractEstablecimiento?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.CondCaractEstablecimiento.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAdministrativa != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA ADMINSITRATIVA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAdministrativa?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAdministrativa.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaRecepcionProducto != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE RECEPCIÓN DE PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaRecepcionProducto?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaRecepcionProducto.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAlmacenamiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAlmacenamiento?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAlmacenamiento.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaProductosDevueltosVencidos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA PARA PRODUCTOS DEVUELTOS Y VENCIDOS ".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaProductosDevueltosVencidos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaProductosDevueltosVencidos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaProductosRetiradosMercado != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA PARA PRODUCTOS RETIRADOS DEL MERCADO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaProductosRetiradosMercado?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaProductosRetiradosMercado.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaDespachoProductos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE DESPACHO DE PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaDespachoProductos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaDespachoProductos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAlmacenProdReqCadenaFrio != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PRODUCTOS QUE REQUIEREN CADENA DE FRÍO ".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAlmacenProdReqCadenaFrio?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAlmacenProdReqCadenaFrio.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAlmacenProdVolatiles != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PRODUCTOS VOLATILES ".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAlmacenProdVolatiles?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAlmacenProdVolatiles.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAlmacenPlaguicidas != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PLAGUICIDAS DE USO DOMÉSTICO Y DE SALUD PÚBLICA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAlmacenPlaguicidas?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAlmacenPlaguicidas.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAlmacenMateriaPrima != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE MATERIA PRIMA PARA LA INDUSTRIA FARMACÉUTICA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAlmacenMateriaPrima?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAlmacenMateriaPrima.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaAlmacenProdSujetosControl != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PRODUCTOS SUJETOS A CONTROL (CUANDO APLIQUE)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaAlmacenProdSujetosControl?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaAlmacenProdSujetosControl.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.AreaDesperdicio != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE DESPERDICIOS QUE SE GENERAN Y NO PUEDEN SER COLOCADOS EN EL ÁREA DE ALMACENAMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.AreaDesperdicio?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.AreaDesperdicio.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.Requisitos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("PROCEDIMIENTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.Requisitos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.Requisitos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.Actividades != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Actividades".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.Actividades?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.Actividades.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspAperCambUbicAgen.Productos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Productos".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicAgen?.Productos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicAgen.Productos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }


                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONES GENERALES").Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            column.Item().PaddingVertical(5).Text("OBSERVACIÓN:").Bold();
                            column.Item().Text("El Acta original se mantendrá en el expediente del establecimiento que permanece en la Dirección Nacional de Farmacia y Drogas y se hace entrega de una copia al firmante de esta acta, al finalizar la inspección").Bold();

                            column.Item().PaddingVertical(5).Text("COMO PARTE DE LOS REQUISITOS PARA LA EMISIÓN DE LA LICENCIA DE OPERACIÓN, LAS DESVIACIONES OBSERVADAS EN LA INSPECCIÓN, DEBERÁNM SER SUBSANADAS EN UN TERMINO NO MAYOR A 20 DÍAS, DENTRO DE LOS CUALES DEBEN NOTIFICAR A LA DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS. PARA REALIZAR LA INSPECCIÓN DEFINITIVA").Bold();

                            if (inspection.DatosConclusiones != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn();
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEGÚN CRITERIO TÉCNICO SE CONCLUYE QUE").Bold();
                                    });

                                    if (inspection.DatosConclusiones.CumpleRequisitosMinOperacion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }
                                    else
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL NO CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspAperCambUbicAgen.DatosSolicitante?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperCambUbicAgen.DatosSolicitante.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspAperCambUbicAgen.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperCambUbicAgen.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspAperCambUbicAgen.DatosSolicitante?.Nombre, inspection.InspAperCambUbicAgen.DatosSolicitante?.Cedula, inspection.InspAperCambUbicAgen.DatosSolicitante?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspAperCambUbicAgen.DatosRegente?.Nombre, inspection.InspAperCambUbicAgen.DatosRegente?.Cedula, inspection.InspAperCambUbicAgen.DatosRegente?.Cargo, inspection.InspAperCambUbicAgen.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                                //table.Cell().ColumnSpan(2).AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });


                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //3 - RUTINA VIGILANCIA FARMACIA
        private async Task<Stream> GenerateRutinaVigilanciaFarmacias(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);

                        page.DefaultTextStyle(x => x.FontSize(8));
                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE INSPECCIONES\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("ACTA DE RUTINA O VIGILANCIA OPERATIVA A FARMACIA").Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            column.Item().AlignLeft().Text(string.Format("No. Recibo: {0}", inspection.DatosEstablecimiento.ReciboPago));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            if (inspection.DatosEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("A) GENERALIDADES DE LA FARMACIA Y REPRESENTANTE LEGAL O PROPIETARIO").Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DEL ESTABLECIMIENTO");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Provincia?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Distrito?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Corregimiento?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Direccion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.Telefono));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Número de Licencia de Operación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.NumLicencia));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Vigente Desde");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.VigenteDesde?.ToString("dd/MM/yyyy") ?? ""));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Vigente Hasta");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.VigenteHasta?.ToString("dd/MM/yyyy") ?? ""));

                                    if (inspection.InspRutinaVigFarmacia.DatosRepresentLegal != null)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre del Representante Legal o Propietario");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRepresentLegal.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRepresentLegal.Cedula);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRepresentLegal.Email);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosSolicitante?.PaisResidencia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosSolicitante?.Provincia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosSolicitante?.Distrito);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosSolicitante?.Corregimiento);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosSolicitante?.Direccion);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspRutinaVigFarmacia.DatosRepresentLegal.TelefonoResid, inspection.InspRutinaVigFarmacia.DatosRepresentLegal.TelefonoMovil));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Profesión");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRepresentLegal.Profesion);
                                    }

                                    table.Footer(footer =>
                                    {
                                        footer.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ley 66 de 10 de noviembre de 1947. Código Sanitario de la República de Panamá. (G.O. 10467 de 6 de diciembre de 1947). Artículo 200.").Bold();
                                        footer.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Prohíbese ejercer conjuntamente las profesiones de médico-cirujano y farmacéutico. A partir de la aprobación de este código, ningún médico que ejerza la profesión podrá ser dueño por sí mismo o por interpuesta persona, accionista o tener participación comercial cualquiera en establecimientos en que se fabriquen, preparen o vendan medicinas y artículos de cualquier clase que se usen para la prevención o curación de enfermedades, corrección de defectos o para el diagnóstico.");
                                    });
                                });

                            }

                            if (inspection.InspRutinaVigFarmacia.DatosRegente != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("B) DATOS SOBRE EL REGENTE FARMACÉUTICO DE LA EMPRESA, FARMACÉUTICO DE TURNO Y TECNICO EN FARMACIA").Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Registro de Idoneidad");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente.NumRegistro);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente.Cedula);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente.Email);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Se encontraba presente al momento de la inspección");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigFarmacia.DatosRegente.PresenteEnInspeccion));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Horario declarado en la Licencia de Operación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente.HorarioRegencia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente?.PaisResidencia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente?.Provincia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente?.Distrito);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente?.Corregimiento);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosRegente?.Ubicacion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspRutinaVigFarmacia.DatosRegente.TelefonoOfic, inspection.InspRutinaVigFarmacia.DatosRegente?.TelefonoMovil));

                                    if (inspection.InspRutinaVigFarmacia.DatosFarmaceutico != null)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cuenta con Farmacéutico de Turno");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigFarmacia.DatosFarmaceutico.CuentaConFarmaceutico));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Horario declarado en la Licencia de Operación");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosFarmaceutico.Horario);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cuenta con Personal (Técnico en Farmacia):");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigFarmacia.DatosFarmaceutico.CuentaConPersonalTecnico));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre de Técnico en Farmacia");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosFarmaceutico.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Registro");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigFarmacia.DatosFarmaceutico.NumRegistro);
                                    }
                                });

                            }

                            if (inspection.InspRutinaVigFarmacia.ExpPersonalFarmacia != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("EXPEDIENTES DEL PERSONAL DE LA FARMACIA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("EXPEDIENTES DEL PERSONAL DE LA FARMACIA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.ExpPersonalFarmacia?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.ExpPersonalFarmacia.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.EstructOrganizFarmacia != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ESTRUCTURA ORGANIZACIONAL DE LA FARMACIA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("C) ESTRUCTURA ORGANIZACIONAL DE LA FARMACIA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.EstructOrganizFarmacia?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.EstructOrganizFarmacia.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.EstructFarmacia != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("INFRAESTRUCTURA DE LA FARMACIA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("D) INFRAESTRUCTURA DE LA FARMACIA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.EstructFarmacia?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.EstructFarmacia.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.AreaFisicaFarmacia != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA FÍSICA DE LA FARMACIA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("ÁREA FÍSICA DE LA FARMACIA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.AreaFisicaFarmacia?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.AreaFisicaFarmacia.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.AreaProdControlados != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("AREA DE PRODUCTOS CONTROLADOS (CUANDO APLIQUE).".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("E) AREA DE PRODUCTOS CONTROLADOS (CUANDO APLIQUE)".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.AreaProdControlados?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.AreaProdControlados.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.RegMovimientoExistencia != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("REGISTRO DE MOVIMIENTO DE EXISTENCIA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("REGISTRO DE MOVIMIENTO DE EXISTENCIA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.RegMovimientoExistencia?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.RegMovimientoExistencia.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.AreaAlmacenMedicamentos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACEN DE MEDICAMENTOS Y OTROS PRODUCTOS PARA LA SALUD HUMANA. (CUANDO APLIQUE)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("F) ÁREA DE ALMACEN DE MEDICAMENTOS Y OTROS PRODUCTOS PARA LA SALUD HUMANA. (CUANDO APLIQUE)".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.AreaAlmacenMedicamentos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.AreaAlmacenMedicamentos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigFarmacia.Procedimientos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("PROCEDIMIENTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("G) PROCEDIMIENTOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.Procedimientos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.Procedimientos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            
                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONES GENERALES").Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            
                            if (inspection.DatosConclusiones != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn();
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEGÚN CRITERIO TÉCNICO SE CONCLUYE QUE").Bold();
                                    });

                                    if (inspection.DatosConclusiones.CumpleRequisitosMinOperacion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }
                                    else
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL NO CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }

                                    if (inspection.DatosConclusiones.ReprogramaInspeccion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("SE REPROGRAMA INSPECCIÓN AL ESTABLECIMIENTO").Bold();
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text("OBSERVACIÓN:").Bold();
                            column.Item().Text("El Acta original se mantendrá en el expediente del establecimiento que pertenece en la Dirección Nacional de Farmacia y Drogas y se hace entrega de una copia al firmante de esta acta, al finalizar la inspección").Bold();

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspRutinaVigFarmacia.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspRutinaVigFarmacia.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspRutinaVigFarmacia.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspRutinaVigFarmacia.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspRutinaVigFarmacia.DatosRepresentLegal?.Nombre, inspection.InspRutinaVigFarmacia.DatosRepresentLegal?.Cedula, inspection.InspRutinaVigFarmacia.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspRutinaVigFarmacia.DatosRegente?.Nombre, inspection.InspRutinaVigFarmacia.DatosRegente?.Cedula, inspection.InspRutinaVigFarmacia.DatosRegente?.Cargo, inspection.InspRutinaVigFarmacia.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });
                            });

                            if (inspection.InspRutinaVigFarmacia.InventarioMedicamento != null) {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("INVENTARIO DE MEDICAMENTOS DE USO CONTROLADO".ToUpper())).Bold();
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header => {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nombre del Producto".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Laboratorio Fabricante".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nº de Lote".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Vencimiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Inventario Realizado".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cant. Registrada en Libro o Sistema".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigFarmacia?.InventarioMedicamento?.LProductos?.Count > 0) {
                                        foreach (var dat in inspection.InspRutinaVigFarmacia.InventarioMedicamento.LProductos) {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Nombre);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Fabricante);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Lote);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.FechaVencimiento?.ToString("dd/MM/yyyy" ?? ""));
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Existencia);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.RegistroSistema);
                                        }

                                    }
                                });

                                column.Item().PaddingVertical(5).AlignLeft().Text("");
                                column.Item().AlignLeft().Text(string.Format("{0} Se realizó inventario al azar de {1} (cantidad) productos, además de estos existen otros a la venta", DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigFarmacia.InventarioMedicamento.InventarioAlAzar), inspection.InspRutinaVigFarmacia.InventarioMedicamento.CantidadAlAzar));
                                column.Item().AlignLeft().Text(string.Format("{0} Se realizó inventario de todos los productos a la venta", DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigFarmacia.InventarioMedicamento.InventarioProductosVenta)));

                                column.Item().PaddingVertical(5).Text(string.Format(" "));
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Firmas:");
                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Autoridad de Salud Pública:");

                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");
                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");
                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("\r\n \r\n");

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por la Empresa o Entidad:");

                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");
                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");

                                });

                            }

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        // 4 - RUTINA VIGILANCIA AGENCIA
        private async Task<Stream> GenerateRutinaVigilanciaAgencia(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));
                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE INSPECCIONES\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("ACTA DE VERIFICACIÓN – VIGILANCIA OPERATIVA AGENCIA DISTRIBUIDORA").Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            column.Item().AlignLeft().Text(string.Format("No. Recibo: {0}", inspection.DatosEstablecimiento.ReciboPago));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            if (inspection.DatosEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("A) GENERALIDADES DEL ESTABLECIMIENTO Y SOLICITANTE").Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DEL ESTABLECIMIENTO");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Provincia?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Distrito?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Corregimiento?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Direccion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.Telefono));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Número de Licencia de Operación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.NumLicencia));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Vigente Desde");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.VigenteDesde?.ToString("dd/MM/yyyy") ?? ""));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Vigente Hasta");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.VigenteHasta?.ToString("dd/MM/yyyy") ?? ""));

                                    if (inspection.InspRutinaVigAgencia.DatosRepresentLegal != null)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre del Representante Legal o Propietario");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRepresentLegal.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRepresentLegal.Cedula);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRepresentLegal.Email);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosSolicitante?.PaisResidencia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosSolicitante?.Provincia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosSolicitante?.Distrito);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosSolicitante?.Corregimiento);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosSolicitante?.Direccion);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspRutinaVigAgencia.DatosRepresentLegal.TelefonoResid, inspection.InspRutinaVigAgencia.DatosRepresentLegal.TelefonoMovil));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Profesión");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRepresentLegal.Profesion);
                                    }

                                    table.Footer(footer =>
                                    {
                                        footer.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ley 66 de 10 de noviembre de 1947. Código Sanitario de la República de Panamá. (G.O. 10467 de 6 de diciembre de 1947). Artículo 200. Prohíbese ejercer conjuntamente las profesiones de médico-cirujano y farmacéutico. A partir de la aprobación de este código, ningún médico que ejerza la profesión podrá ser dueño por sí mismo o por interpuesta persona, accionista o tener participación comercial cualquiera en establecimientos en que se fabriquen, preparen o vendan medicinas y artículos de cualquier clase que se usen para la prevención o curación de enfermedades, corrección de defectos o para el diagnóstico");
                                    });
                                });

                            }

                            if (inspection.InspRutinaVigAgencia.DatosRegente != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("B) DATOS SOBRE EL REGENTE FARMACéUTICO DE LA EMPRESA".ToUpper()).Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Registro de Idoneidad");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente.NumRegistro);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente.Cedula);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente.Email);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Se encontraba presente al momento de la inspección?");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigAgencia.DatosRegente.PresenteEnInspeccion));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("El Regente Farmacéutico realiza otras funciones del dentro de la empresa?");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigAgencia.DatosRegente.RealizaOtraFuncion));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Horario declarado en la Licencia de Operación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente.HorarioRegencia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente?.PaisResidencia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente?.Provincia);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente?.Distrito);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente?.Corregimiento);
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspRutinaVigAgencia.DatosRegente?.Ubicacion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspRutinaVigAgencia.DatosRegente.TelefonoOfic, inspection.InspRutinaVigAgencia.DatosRegente?.TelefonoMovil));

                                });

                            }

                            if (inspection.InspRutinaVigAgencia.CondCaractEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("CONDICIONES Y CARACTERÍSTICAS DEL ESTABLECIMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("C) CONDICIONES Y CARACTERÍSTICAS DEL ESTABLECIMIENTO").Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.CondCaractEstablecimiento?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.CondCaractEstablecimiento.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAdministrativa != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA ADMINSITRATIVA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("D) ÁREA ADMINSITRATIVA").Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAdministrativa?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAdministrativa.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaRecepcionProducto != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE RECEPCIÓN DE PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("E) ÁREA DE RECEPCIÓN DE PRODUCTOS").Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaRecepcionProducto?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaRecepcionProducto.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAlmacenamiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("F) ÁREA DE ALMACENAMIENTO").Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAlmacenamiento?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAlmacenamiento.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaProductosDevueltosVencidos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA PARA PRODUCTOS DEVUELTOS Y VENCIDOS ".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("G) ÁREA PARA PRODUCTOS DEVUELTOS Y VENCIDOS ".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaProductosDevueltosVencidos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaProductosDevueltosVencidos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaProductosRetiradosMercado != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA PARA PRODUCTOS RETIRADOS DEL MERCADO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("H) ÁREA PARA PRODUCTOS RETIRADOS DEL MERCADO".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaProductosRetiradosMercado?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaProductosRetiradosMercado.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaDespachoProductos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE DESPACHO DE PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("I) ÁREA DE DESPACHO DE PRODUCTOS".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaDespachoProductos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaDespachoProductos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAlmacenProdReqCadenaFrio != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PRODUCTOS QUE REQUIEREN CADENA DE FRÍO (CUANDO APLIQUE)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("J) ÁREA DE ALMACENAMIENTO DE PRODUCTOS QUE REQUIEREN CADENA DE FRÍO (CUANDO APLIQUE)".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAlmacenProdReqCadenaFrio?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAlmacenProdReqCadenaFrio.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAlmacenProdVolatiles != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PRODUCTOS VOLATILES (CUANDO APLIQUE)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("K) ÁREA DE ALMACENAMIENTO DE PRODUCTOS VOLATILES(CUANDO APLIQUE)".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAlmacenProdVolatiles?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAlmacenProdVolatiles.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAlmacenPlaguicidas != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PLAGUICIDAS DE USO DOMÉSTICO Y DE SALUD PÚBLICA (CUANDO APLIQUE)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("L) ÁREA DE ALMACENAMIENTO DE PLAGUICIDAS DE USO DOMÉSTICO Y DE SALUD PÚBLICA (CUANDO APLIQUE)".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAlmacenPlaguicidas?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAlmacenPlaguicidas.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAlmacenMateriaPrima != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE MATERIA PRIMA PARA LA INDUSTRIA FARMACÉUTICA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("M) ÁREA DE ALMACENAMIENTO DE MATERIA PRIMA PARA LA INDUSTRIA FARMACÉUTICA".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAlmacenMateriaPrima?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAlmacenMateriaPrima.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.AreaAlmacenProdSujetosControl != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREA DE ALMACENAMIENTO DE PRODUCTOS SUJETOS A CONTROL (CUANDO APLIQUE)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("N) ÁREA DE ALMACENAMIENTO DE PRODUCTOS SUJETOS A CONTROL (CUANDO APLIQUE)".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.AreaAlmacenProdSujetosControl?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.AreaAlmacenProdSujetosControl.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.Procedimientos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("PROCEDIMIENTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("O) PROCEDIMIENTOS".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.Procedimientos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.Procedimientos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.Transporte != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Transporte".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("P) Transporte".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.Transporte?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.Transporte.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text("OBSERVACIÓN:").Bold();
                            column.Item().Text("El Acta original se mantendrá en el expediente del establecimiento que permanece en la Dirección Nacional de Farmacia y Drogas y se hace entrega de una copia al firmante de esta acta, al finalizar la inspección").Bold();

                            
                            if (inspection.InspRutinaVigAgencia.Actividades != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Actividades".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.Actividades?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.Actividades.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            if (inspection.InspRutinaVigAgencia.Productos != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Productos".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.Productos?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.Productos.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            
                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONES GENERALES").Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            
                            if (inspection.DatosConclusiones != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn();
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEGÚN CRITERIO TÉCNICO SE CONCLUYE QUE").Bold();
                                    });

                                    if (inspection.DatosConclusiones.CumpleRequisitosMinOperacion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }
                                    else
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL NO CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }

                                    if (inspection.DatosConclusiones.ReprogramaInspeccion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("SE REPROGRAMA INSPECCIÓN AL ESTABLECIMIENTO").Bold();
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspRutinaVigAgencia.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspRutinaVigAgencia.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspRutinaVigAgencia.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspRutinaVigAgencia.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspRutinaVigAgencia.DatosRepresentLegal?.Nombre, inspection.InspRutinaVigAgencia.DatosRepresentLegal?.Cedula, inspection.InspRutinaVigAgencia.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspRutinaVigAgencia.DatosRegente?.Nombre, inspection.InspRutinaVigAgencia.DatosRegente?.Cedula, inspection.InspRutinaVigAgencia.DatosRegente?.Cargo, inspection.InspRutinaVigAgencia.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                           });

                            if (inspection.InspRutinaVigAgencia.InventarioMedicamento != null) {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("INVENTARIO DE MEDICAMENTOS DE USO CONTROLADO".ToUpper())).Bold();
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)2);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header => {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nombre del Producto".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Laboratorio Fabricante".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nº de Lote".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Vencimiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Existencia Física".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Registro en Libro o sistema".ToUpper());
                                    });
                                    if (inspection.InspRutinaVigAgencia?.InventarioMedicamento?.LProductos?.Count > 0) {
                                        foreach (var dat in inspection.InspRutinaVigAgencia.InventarioMedicamento.LProductos) {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Nombre);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Fabricante);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Lote);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.FechaVencimiento?.ToString("dd/MM/yyyy" ?? ""));
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Existencia);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.RegistroSistema);
                                        }

                                    }
                                });

                                column.Item().PaddingVertical(5).AlignLeft().Text("");
                                column.Item().AlignLeft().Text(string.Format("{0} Se realizó inventario al azar de {1} (cantidad) productos, además de estos existen otros a la venta", DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigAgencia.InventarioMedicamento.InventarioAlAzar), inspection.InspRutinaVigAgencia.InventarioMedicamento.CantidadAlAzar));
                                column.Item().AlignLeft().Text(string.Format("{0} Se realizó inventario de todos los productos a la venta", DataModel.Helper.Helper.GetDescription(inspection.InspRutinaVigAgencia.InventarioMedicamento.InventarioProductosVenta)));

                                column.Item().PaddingVertical(5).Text(string.Format(" "));
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Firmas:");
                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Autoridad de Salud Pública:");

                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");
                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");
                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("\r\n \r\n");

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por la Empresa o Entidad:");

                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");
                                    table.Cell().AlignLeft().Text("Nombre: \r\nCargo:\r\nIdoneidad:\r\n");

                                });

                            }

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //5 - INVESTIGACIONES
        private async Task<Stream> GenerateInvestigaciones(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);
                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("ACTA DE INSPECCIóN".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            //column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            //column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            //column.Item().AlignLeft().Text(string.Format("No. Recibo: {0}", inspection.DatosEstablecimiento.ReciboPago));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Nombre del establecimiento:{0}", inspection.DatosEstablecimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Provincia:{0}", inspection.DatosEstablecimiento?.Provincia?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Distrito:{0}", inspection.DatosEstablecimiento?.Distrito?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Corregimiento:{0}", inspection.DatosEstablecimiento?.Corregimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Ubicación:{0}", inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Número de Licencia de Operación:{0}", inspection?.DatosEstablecimiento?.NumLicencia));
                            column.Item().AlignLeft().Text(string.Format("Aviso de Operación:{0}", inspection?.DatosEstablecimiento?.AvisoOperaciones));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Siendo las {0} del {1} de {2} de {3}; actuando como colaboradores de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud, procedimos a realizar inspección al establecimiento antes descrito, para verificar {4}",
                                inspection.FechaInicio.ToString("hh:mm tt"), inspection.FechaInicio.Day, Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.FechaInicio.ToString("MM"))), inspection.FechaInicio.Year, inspection?.InspInvestigacion?.DetallesInvestigacion?.DetalleVerificacion));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Al llegar al establecimiento fuimos atendidos por {0} con cargo de {1}, y documento de identidad personal N° {2}. A quien se le informó el motivo de la visita.",
                                inspection?.InspInvestigacion?.DatosAtendidosPor?.Nombre, inspection?.InspInvestigacion?.DatosAtendidosPor?.Cargo, inspection.InspInvestigacion?.DatosAtendidosPor?.Cedula));

                            column.Item().PaddingVertical(5).AlignLeft().Text("Por la Dirección Nacional de Farmacia y Drogas, participaron:");
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(tbl =>
                                {
                                    tbl.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.7);
                                        columns.RelativeColumn((float)0.3);
                                    });

                                    tbl.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("Nombre").Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignLeft().Padding(3).Text("No. Idoneidad").Bold();
                                    });

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        tbl.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(participant.NombreCompleto);
                                        tbl.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(participant.RegistroNumero);
                                    }
                                });
                            }


                            
                            if (inspection.InspInvestigacion.DetallesInvestigacion != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Motivo de la Investigación:\r\n{0}", inspection.InspInvestigacion.DetallesInvestigacion.DetalleVerificacion));

                                column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Detalles de la Inspección:\r\n{0}", inspection.InspInvestigacion.DetallesInvestigacion.DetalleInspeccion));
                                //column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Se adjunta acta de retención y retiro de productos: {0}", DataModel.Helper.Helper.GetDescription(inspection.InspInvestigacion.DetallesInvestigacion.AdjuntaActaRetencion)));
                                //column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("No se puede movilizar los productos hasta culminar la investigación: {0}", DataModel.Helper.Helper.GetDescription(inspection.InspInvestigacion.DetallesInvestigacion.MovilizarProductos)));
                            }



                            //column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            //{
                            //    table.ColumnsDefinition(columns =>
                            //    {
                            //        columns.RelativeColumn();
                            //    });

                            //    table.Header(header =>
                            //    {
                            //        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Se Finaliza la Inspección por").Bold();
                            //    });

                            //    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection?.DatosConclusiones?.ObservacionesFinales);

                            //});

                            //column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            //{
                            //    table.ColumnsDefinition(columns =>
                            //    {
                            //        columns.RelativeColumn();
                            //    });

                            //    table.Header(header =>
                            //    {
                            //        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Se Finaliza la Inspección por".ToUpper()).Bold();
                            //    });
                            //    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection?.InspInvestigacion?.DetallesInvestigacion?.DetalleVerificacion).Bold();

                            //});

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0) {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes) {
                                        table.Cell().Table(tbl => {
                                            tbl.ColumnsDefinition(columns => {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma)) {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection?.InspInvestigacion?.DatosAtendidosPor?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspInvestigacion.DatosAtendidosPor.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                //if (!string.IsNullOrEmpty(inspection?.InspInvestigacion?.DatosAtendidosPor?.Firma))
                                //{
                                //    //var bytes = Convert.FromBase64String(base64encodedstring);
                                //    //var contents = new StreamContent(new MemoryStream(bytes));
                                //    byte[] data = Convert.FromBase64String(inspection.InspInvestigacion.DatosAtendidosPor.Firma.Split("image/png;base64,")[1]);
                                //    MemoryStream memoryStream = new MemoryStream(data);
                                //    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                //}
                                //else
                                //{
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                //}


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection?.InspInvestigacion?.DatosAtendidosPor?.Nombre, inspection?.InspInvestigacion?.DatosAtendidosPor?.Cedula, inspection?.InspInvestigacion?.DatosAtendidosPor?.Cargo));
                                //table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspRutinaVigAgencia.DatosRegente?.Nombre, inspection.InspRutinaVigAgencia.DatosRegente?.Cedula, inspection.InspRutinaVigAgencia.DatosRegente?.Cargo, inspection.InspRutinaVigAgencia.DatosRegente?.NumRegistro));
                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(string.Format("Fecha y Hora de finalizada la inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });

                            
                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });

                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        // 6 - RETIRO Y RETENCION
        private async Task<Stream> GenerateRetentionReceptionPDF(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("ACTA DE RETENCIÓN Y/O RETIRO DE PRODUCTOS FARMACÉUTICOS").Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            string participantes = "";
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                foreach (var partic in inspection.ParticipantesDNFD.LParticipantes)
                                {
                                    participantes += partic.NombreCompleto + ", ";
                                }
                            }

                            column.Item().Text(string.Format("Siendo las {0} del día {1} de {2} de {3}, actuando en representación de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud, procedimos a efectuar la {4}, de los productos a continuación descritos y que fueron localizados en el establecimiento denominado: {5}, ubicado en: {6}, con Aviso de Operación No. {7} y Licencia de operación {8}/DNFD. Y cuyo Representante Legal es {9} con documento de identidad personal N° {10}. Por la Dirección Nacional de Farmacia y Drogas, participamos: {11}. Y fuimos atendidos por: {12}, con cargo {13} cip: {14}\r\n",
                                inspection.FechaInicio.ToString("hh:mm tt"), inspection.FechaInicio.ToString("dd"), Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.FechaInicio.ToString("MM"))), inspection.FechaInicio.ToString("yyyy"), DataModel.Helper.Helper.GetDescription(inspection.InspRetiroRetencion.RetiroRetencionType), inspection.DatosEstablecimiento?.Nombre ?? "", inspection.DatosEstablecimiento?.Direccion, inspection.DatosEstablecimiento?.AvisoOperaciones, inspection.DatosEstablecimiento?.NumLicencia, inspection.InspRetiroRetencion.DatosRepresentLegal?.Nombre, inspection.InspRetiroRetencion.DatosRepresentLegal?.Cedula, participantes, inspection.InspRetiroRetencion.DatosAtendidosPor?.Nombre, inspection.InspRetiroRetencion.DatosAtendidosPor?.Cargo, inspection.InspRetiroRetencion.DatosAtendidosPor?.Cedula));

                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nombre del Producto").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Presentación Comercial").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Fabricante").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("País de Fabricación").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Lote").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Fecha de Exp.").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cant. Retenida").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cant. Retirada").Bold();
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Motivo de la Retención y/o Retiro").Bold();

                                });

                                //table.Cell().ColumnSpan(3).AlignLeft().Padding(3).Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS").Bold();
                                if (inspection.InspRetiroRetencion?.LProductos?.Count>0)
                                {
                                    foreach (var prod in inspection.InspRetiroRetencion.LProductos)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.PresentacionComercial);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.Fabricante);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.Pais);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.Lote);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.FechaExp?.ToString("dd/MM/yyyy") ?? "");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.CantidadRetenida);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.CantidadRetirada);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(prod.Motivo);

                                        static IContainer CellStyle(IContainer container) => container.BorderBottom(1).BorderColor(Colors.Grey.Lighten2).PaddingVertical(5);
                                    }
                                }

                            });

                            column.Item().PaddingVertical(5).Text(string.Format("Los productos retenidos y retirados del establecimiento se mantendrán bajo custodia en las instalaciones de la Dirección Nacional de Farmacia y Drogas, hasta culminar las investigaciones.\r\nLos productos farmacéuticos que se mantengan retenidos en el local no podrán ser movidos del lugar donde se fijó su ubicación al momento de levantar este documento.\r\n"));

                            ////////////////////////////
                            ///

                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("Conclusiones".ToUpper())).Bold();
                            column.Item().AlignCenter().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            //column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            //{
                            //    table.ColumnsDefinition(columns =>
                            //    {
                            //        columns.RelativeColumn();
                            //    });

                            //    table.Header(header =>
                            //    {
                            //        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Observaciones".ToUpper()).Bold();
                            //    });

                            //    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            //});

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspRetiroRetencion.DatosAtendidosPor?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspRetiroRetencion.DatosAtendidosPor.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }
                                //if (!string.IsNullOrEmpty(inspection.InspRetiroRetencion.DatosRegente?.Firma))
                                //{
                                //    //var bytes = Convert.FromBase64String(base64encodedstring);
                                //    //var contents = new StreamContent(new MemoryStream(bytes));
                                //    byte[] data = Convert.FromBase64String(inspection.InspRetiroRetencion.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                //    MemoryStream memoryStream = new MemoryStream(data);
                                //    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                //}
                                //else
                                //{
                                //    table.Cell().AlignLeft().Padding(3).Text("");
                                //}
                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspRetiroRetencion.DatosAtendidosPor?.Nombre, inspection.InspRetiroRetencion.DatosAtendidosPor?.Cedula, inspection.InspRetiroRetencion.DatosAtendidosPor?.Cargo));
                                table.Cell().AlignLeft().Padding(3).Text(""); //table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspRetiroRetencion.DatosRegente.Nombre, inspection.InspRetiroRetencion.DatosRegente.Cedula, inspection.InspRetiroRetencion.DatosRegente.Cargo, inspection.InspRetiroRetencion.DatosRegente.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().ColumnSpan(3).AlignLeft().Padding(3).PaddingVertical(5).Text(" ").Bold();
                                if (inspection.ParticipantesDNFD?.LParticipantes?.Count >0)
                                {
                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg. No.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));

                                        });
                                    }
                                }

                            });

                            column.Item().PaddingVertical(5).Text(" ");
                            column.Item().AlignBottom().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn((float)1.5);
                                });

                                table.Cell().AlignLeft().Padding(3).Text(" ");

                                table.Cell().Border(1).BorderColor(Colors.Black).Padding(10).AlignBottom().AlignLeft().Padding(3).Column(col =>
                                {
                                    col.Item().AlignLeft().Padding(3).Text("Para uso de la Administración de la DNFD:").Bold();
                                    col.Item().PaddingTop(5).Text("Productos recibidos por (nombre): _____________________________________________________________");
                                    col.Item().PaddingTop(15).Text("(firma): ___________________________________________________________________________________________");
                                    col.Item().PaddingTop(15).Text("Fecha (dd/MM/yyyy): __________________________     Hora: __________________________");
                                });

                            });

                            column.Item().PaddingVertical(5).Text(string.Format("Fecha y Hora de finalizada la inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });


                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        // 7 - CIERRE DE OPERACIONES
        private async Task<Stream> GenerateCierreOperaciones(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("ACTA DE CIERRE DE OPERACIONES DE ESTABLECIMIENTOS FARMACEUTICOS").Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");


                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento.TipoEstablecimiento)));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("DATOS GENERALES:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre del Establecimiento: {0}", inspection.DatosEstablecimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Nº de Licencia de Operación: {0}, Fecha de vencimiento: {1}", inspection.DatosEstablecimiento?.NumLicencia, inspection.DatosEstablecimiento?.VigenteHasta?.ToString("dd/MM/yyyy") ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Provincia: {0}, Distrito: {1}, Corregimiento: {2}", inspection.DatosEstablecimiento?.Provincia?.Nombre, inspection.DatosEstablecimiento?.Distrito?.Nombre, inspection.DatosEstablecimiento?.Corregimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Ubicación: {0}", inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Teléfono(s): {0}, Correo electrónico: {1}", inspection.DatosEstablecimiento?.Telefono, inspection.DatosEstablecimiento?.Correo));

                            //column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Datos del Responsable del Establecimiento:".ToUpper())).Bold();
                            //column.Item().AlignLeft().Text(string.Format("Nombre del Responsable: {0}", inspection.InspCierreOperacion.DatosResponsable.Nombre));
                            //column.Item().AlignLeft().Text(string.Format("Nº de Cédula: {0}", inspection.InspCierreOperacion.DatosResponsable.Cedula));
                            //column.Item().AlignLeft().Text(string.Format("Cargo: {0}", inspection.InspCierreOperacion.DatosResponsable.Cargo));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Siendo las {0} del {1} de {2} de {3}, y actuando como colaboradores de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud, los suscritos:",
                                inspection.FechaInicio.ToString("hh:mm tt"), inspection.FechaInicio.Day, Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.FechaInicio.ToString("MM"))), inspection.FechaInicio.Year));

                            if (inspection.ParticipantesDNFD?.LParticipantes != null)
                            {
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(6);
                                                columns.RelativeColumn(4);
                                            });

                                            tbl.Cell().AlignLeft().Padding(3).Text(string.Format("Lic. {0}", participant.NombreCompleto));
                                            tbl.Cell().AlignLeft().Padding(3).Text(string.Format("Idoneidad profesional N°. {0}", participant.RegistroNumero));

                                        });
                                    }
                                });
                            }
                            column.Item().AlignLeft().Text(string.Format("Procedimos a efectuar inspección al establecimiento antes señalado, para constatar “in situ” el CIERRE DE OPERACIONES, para dar respuesta a solicitud de {0}", inspection.InspCierreOperacion.DatosInspeccion?.SolicitudCierre));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Observaciones sobre la ubicación:  {0}", inspection.InspCierreOperacion.DatosInspeccion?.ObservacionUbicacion));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Observaciones sobre el destino de los productos farmacéuticos (incluir los sujetos a control especial y el libro de registro):  {0}", inspection.InspCierreOperacion.DatosInspeccion?.DestinoProductos));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Por lo cual, concluyen las operaciones del establecimiento que fueron autorizadas a través de licencia de operación N° {0}, y se procederá a cerrar el expediente  que reposa en la Dirección Nacional de Farmacia y Drogas.", inspection.DatosEstablecimiento?.NumLicencia));

                            column.Item().PaddingVertical(5).Text(string.Format("Los abajo firmantes damos fe de lo antes descrito"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                //table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                //if (!string.IsNullOrEmpty(inspection.InspCierreOperacion.DatosRepresentLegal?.Firma))
                                //{
                                //    //var bytes = Convert.FromBase64String(base64encodedstring);
                                //    //var contents = new StreamContent(new MemoryStream(bytes));
                                //    byte[] data = Convert.FromBase64String(inspection.InspCierreOperacion.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                //    MemoryStream memoryStream = new MemoryStream(data);
                                //    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                //}
                                //else
                                //{
                                //    table.Cell().AlignLeft().Padding(3).Text("");
                                //}
                                //table.Cell().AlignLeft().Padding(3).Text("");
                                //table.Cell().AlignLeft().Padding(3).Text("");

                                //table.Cell().AlignLeft().Padding(3).Text(string.Format("{0}\r\nCédula:{1}", inspection.InspCierreOperacion.DatosRepresentLegal?.Nombre, inspection.InspCierreOperacion.DatosRepresentLegal?.Cedula));

                                //table.Cell().AlignLeft().Padding(3).Text("");
                                //table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().ColumnSpan(3).AlignLeft().Padding(3).PaddingVertical(5).Text(" ").Bold();
                                if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                                {
                                    table.Cell().ColumnSpan(3).AlignLeft().Padding(3).Text("Por la Dirección Nacional de Farmacia y Drogas:").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));

                                        });
                                    }
                                }
                            });

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        // 8 - DISPOSICION FINAL DEL PRODUCTO
        private async Task<Stream> GenerateDisposicionFinalProd(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos  \r\nSECCIÓN DE INSPECCIONES\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("DISPOSICIÓN FINAL DE DESECHOS FARMACÉUTICOS").Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection?.DatosEstablecimiento?.Establecimiento?.TipoEstablecimiento ?? DataModel.Helper.enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                            column.Item().AlignLeft().Text(string.Format("Siendo las {0} del {1} de {2} de {3}, los suscritos:",
                                inspection.FechaInicio.ToString("hh:mm tt"), inspection.FechaInicio.Day, Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.FechaInicio.ToString("MM"))), inspection.FechaInicio.Year));
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().AlignLeft().Padding(3).Text(string.Format("Lic. {0}", participant.NombreCompleto));
                                        table.Cell().AlignLeft().Padding(3).Text(string.Format("Idoneidad N°. {0}", participant.RegistroNumero));
                                        table.Cell().AlignLeft().Padding(3).Text(" ");
                                        table.Cell().AlignLeft().Padding(3).Text(" ");

                                    }
                                });
                            }

                            column.Item().AlignLeft().Text(string.Format("Actuando como colaboradores de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud, nos apersonamos al establecimiento denominado: {0}, ubicado en: {1}. \r\nCon la finalidad de realizar:", inspection.DatosEstablecimiento?.Nombre, inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection?.InspDisposicionFinal?.DatosInspeccion?.TipoInspeccion ?? enum_TipoInspeccionDispFinal.VerifInventario)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Producto: {0}", DataModel.Helper.Helper.GetDescription(inspection?.InspDisposicionFinal?.DatosInspeccion?.TipoProduct ?? enum_TipoProductDispFinal.Controlado)));
                            //column.Item().AlignLeft().Text(string.Format("Tipo de Verificación: {0}", DataModel.Helper.Helper.GetDescription(inspection?.InspDisposicionFinal?.DatosInspeccion?.TipoVerificacion ?? enum_TipoVerificacionDispFinal.NA)));
                            column.Item().AlignLeft().Text(string.Format("Disposición final solicitado por: {0}", inspection?.InspDisposicionFinal?.DatosInspeccion?.SolicitudCierre));
                            column.Item().AlignLeft().Text(string.Format("N° de nota de SDGSA: {0}", inspection?.InspDisposicionFinal?.DatosInspeccion?.NumNotaSDGSA));

                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(" ").Bold();

                            column.Item().AlignLeft().Text(string.Format("La solicitud corresponde al expediente con recibo de pago N°: {0}", inspection?.InspDisposicionFinal?.DatosInspeccion?.NumReciboPago));
                            column.Item().AlignLeft().Text(string.Format("El peso de los productos a destruir es: {0} (Kg)", inspection?.InspDisposicionFinal?.DatosInspeccion?.PesoDestruir));
                            column.Item().AlignLeft().Text(string.Format("Adjunto lista de productos: {0}", inspection.InspDisposicionFinal.DatosInspeccion.Adjunta ? "Si" : "No"));
                            column.Item().AlignLeft().Text(string.Format("Total: {0} cajas/tarimas/bultos", inspection?.InspDisposicionFinal?.DatosInspeccion?.Total));

                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("Lista de Productos".ToUpper())).Bold();

                            if (inspection?.InspDisposicionFinal?.InventarioMedicamento?.LProductos?.Count > 0)
                            {
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn();
                                        columns.RelativeColumn();
                                        columns.RelativeColumn();
                                        columns.RelativeColumn();
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cantidad".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nombre del producto".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Presentación".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Motivos".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspDisposicionFinal.InventarioMedicamento.LProductos)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Cantidad);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Presentacion);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Motivos);
                                    }
                                });
                            }

                            //column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Observaciones:".ToUpper())).Bold();
                            //column.Item().AlignLeft().Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("Conclusiones".ToUpper())).Bold();

                            column.Item().AlignLeft().Text(string.Format("Luego de realizar {0} de los desechos farmacéuticos, se encontró que la existencia física {1} coincide con el registro en la lista que adjuntó el establecimiento a la solicitud.", DataModel.Helper.Helper.GetDescription(inspection?.InspDisposicionFinal?.DatosInspeccion?.TipoInspeccion ?? enum_TipoInspeccionDispFinal.VerifInventario), inspection.InspDisposicionFinal.DatosInspeccion.Coincide ? "Si" : "No"));

                            column.Item().PaddingVertical(5).AlignLeft().Text("La Dirección Nacional de Farmacia y Drogas y sus colaboradores quedan relevados de cualquier compromiso y responsabilidad que pudiera derivarse de la destrucción de estos desechos farmacéuticos o del manejo inadecuado de los mismos");

                            column.Item().PaddingVertical(5).Text(string.Format("Los abajo firmantes damos fe de lo antes descrito"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspDisposicionFinal?.DatosAtendidosPor?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspDisposicionFinal.DatosAtendidosPor.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }
                                table.Cell().AlignLeft().Padding(3).Text("");
                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Padding(3).Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspDisposicionFinal.DatosAtendidosPor.Nombre, inspection.InspDisposicionFinal.DatosAtendidosPor.Cedula, inspection.InspDisposicionFinal.DatosAtendidosPor.Cargo));

                                table.Cell().AlignLeft().Padding(3).Text("");
                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().ColumnSpan(3).AlignLeft().Padding(3).PaddingVertical(5).Text(" ").Bold();
                                if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                                {
                                    table.Cell().ColumnSpan(3).AlignLeft().Padding(3).Text("Por la Dirección Nacional de Farmacia y Drogas:").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));

                                        });
                                    }
                                }
                            });

                            column.Item().PaddingVertical(5).Text(string.Format("Fecha y Hora de finalizada la inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //9 - Apertura de Fabricantes - Medicamentos
        private async Task<Stream> GenerateAperturaFabricantesMedicamentos(AUD_InspeccionTB inspection)
        {
            try
            {
                //var textColor = new QuestPDF.Helpers. { Color = Color.Red };
                //table.DefaultCellStyle(textColor);
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("Evaluación Técnica para Fabricante de Medicamentos".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento?? enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)0.3);
                                    columns.RelativeColumn((float)0.7);
                                });

                                table.Header(header =>
                                {
                                    header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("DATOS GENERALES").Bold();
                                });

                                //Establecimiento
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1. Establecimiento");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Nombre);
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.2 Ubicación");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Provincia?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Distrito?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Corregimiento?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Direccion);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.3 Teléfono");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Telefono));
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.4 Correo Electronico");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Correo));

                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("2. Regente farmacéutico(a)");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("2.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricante?.DatosRegente?.Nombre);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricante?.DatosRegente?.Cedula);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("2.2 Num. Registro");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricante?.DatosRegente?.NumRegistro);

                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3. Propietario o Representante Legal");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricante?.DatosRepresentLegal?.Nombre);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricante?.DatosRepresentLegal?.Cedula);

                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("4. Productos que fabricarán( adjuntar listado si lo poseen)");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("4.1 Tipo");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricante?.ProdFabrican?.ProductosDesc);

                            });

                            if (inspection.InspAperFabricante?.Instalaciones?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("PERSONAL".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.Personal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.Instalaciones?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Instalaciones".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.Instalaciones.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.AreaAlmacenamiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de Almacenamiento".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Materia Prima".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Material de Acondicionamiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Producto Terminado".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Producto a Granel".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Inflamables".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Rechazados".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Devoluciones".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.AreaAlmacenamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(8).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");

                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));

                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.AreaDispMateriaPrima?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de Dispensado de Materia Prima".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.AreaDispMateriaPrima.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.AreaProduccion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de Producción".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Líquidos".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Semisólidos".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Sólidos".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.AreaProduccion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.AreaAcondSecundario?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREAS DE ACONDICIONAMIENTO SECUNDARIO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.AreaAcondSecundario.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.ControlCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CONTROL DE CALIDAD".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.ControlCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.AreaAuxiliares?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREAS AUXILIARES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.AreaAuxiliares.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.Equipos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EQUIPOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Líquidos".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Semisólidos".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Sólidos".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.Equipos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 1)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricante?.MaterialesProductos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("MATERIALES Y PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricante.MaterialesProductos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            //column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("Procedimientos Operativos Estándares:")).Bold();
                            //column.Item().AlignLeft().Text("El establecimiento se compromete a que los procedimientos operativos estandarizados (POE’S) y documentación relacionada a estos, estén completos y acorde con la Normativa vigente y según las actividades a las que se dedicará el establecimiento.  De igual forma el establecimiento deberá tener a disposición de la Autoridad Reguladora los procedimientos operativos estandarizados (POE’S) y documentación relacionada a estos cuando esta lo solicite y al momento de Auditoría de Buenas prácticas de Fabricación.");

                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("CRITERIO TÉCNICO")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Una vez evaluado el cumplimiento de los requerimientos previstos y con base en el REGLAMENTO TECNICO CENTROAMERICANO RTCA 11.03.42:07 REGLAMENTO TÉCNICO SOBRE BUENAS PRÁCTICAS DE MANUFACTURA PARA LA INDUSTRIA FARMACÉUTICA. PRODUCTOS FARMACÉUTICOS Y MEDICAMENTOS DE USO HUMANO, por el cual se reglamentan las Buenas Prácticas de Manufactura de Productos Farmacéuticos.  Inspectores Farmacéuticos de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud de Panamá concluyen que el establecimiento denominado {0}, ubicado en {1}, {2} con los requisitos mínimos para operar como Laboratorio Farmacéutico dedicado a {3}. \r\nDado en la ciudad de Panamá a los {4} días del mes de {5} de {6}.", inspection.DatosEstablecimiento?.Nombre??"", inspection.DatosEstablecimiento?.Direccion??"", (inspection.DatosConclusiones!=null && inspection.DatosConclusiones.CumpleRequisitosMinOperacion ? "SÍ CUMPLE" : "NO CUMPLE"), DataModel.Helper.Helper.GetDescription(inspection.InspAperFabricante.ProdFabrican?.TipoProductos?? enumTipoProductosImportacion.Otros) + (inspection.InspAperFabricante.ProdFabrican?.TipoProductos == enumTipoProductosImportacion.Otros? inspection.InspAperFabricante.ProdFabrican?.ProductosDesc??"":""),  inspection.DatosConclusiones?.FechaFinalizacion?.Day, Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.DatosConclusiones ? .FechaFinalizacion?.ToString("MM") ?? "01")), inspection.DatosConclusiones?.FechaFinalizacion?.Year.ToString() ?? ""));
                               
                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspAperFabricante.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperFabricante.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspAperFabricante.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperFabricante.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspAperFabricante.DatosRepresentLegal?.Nombre, inspection.InspAperFabricante.DatosRepresentLegal?.Cedula, inspection.InspAperFabricante.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspAperFabricante.DatosRegente?.Nombre, inspection.InspAperFabricante.DatosRegente?.Cedula, inspection.InspAperFabricante.DatosRegente?.Cargo, inspection.InspAperFabricante.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Inconformidades o desviaciones detectadas".ToUpper()).Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                              });

                            });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //10 - Apertura de Fabricantes - Cosmeticos y Desinfectantes
        private async Task<Stream> GenerateAperturaFabricantesCosmeticoDesinfectantes(AUD_InspeccionTB inspection)
        {
            try
            {                
                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("Evaluación Técnica para Fabricante\r\n(Cosméticos, Antisépticos, Desinfectantes y Plaguicidas de uso doméstico)".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");


                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)0.3);
                                    columns.RelativeColumn((float)0.7);
                                });

                                table.Header(header =>
                                {
                                    header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("DATOS GENERALES").Bold();
                                });

                                //Establecimiento
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1. ESTABLECIMIENTO".ToUpper());
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Nombre);
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.2 Ubicacion:");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Provincia");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Provincia?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Distrito");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Distrito?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Corregimiento");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Corregimiento?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Ubicación");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Direccion);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.3 Teléfono");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Telefono));
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.4 Correo Electronico");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Correo));

                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("2. REGENTE FARMACEUTICO(A)".ToUpper());
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("2.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.DatosRegente?.Nombre);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.DatosRegente?.Cedula);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("2.2 Nº de Registro");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.DatosRegente?.NumRegistro);

                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3. PROPIETARIO O REPRESENTANTE LEGAL".ToUpper());
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.DatosRepresentLegal?.Nombre);
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.DatosRepresentLegal?.Cedula);

                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("4. Productos que fabricarán (adjuntar listado si lo poseen)".ToUpper());
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("4.1 Tipo");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.ProdFabrican?.ProductosDesc);

                            });

                            if (inspection.InspAperFabricanteCosmetMed?.EstructuraOrganizativa?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("GENERALIDADES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.EstructuraOrganizativa.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.Almacenes?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ALMACENES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.Almacenes.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.Almacenes2?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Áreas de Almacenamiento".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1.5);
                                        columns.RelativeColumn((float)1.5);
                                        columns.RelativeColumn((float)1.5);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Materia Prima".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Material de Acondicionamiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Producto Terminado".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.Almacenes2.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" ");

                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));

                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.Documantacion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("DOCUMENTACIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.Documantacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                                                                                    
                            if (inspection.InspAperFabricanteCosmetMed?.AreasAuxiliares?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Áreas Auxiliares".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.AreasAuxiliares.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.SistemaCriticoApoyo?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("III - SISTEMAS CRITICOS DE APOYO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.SistemaCriticoApoyo.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.AreaProduccion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("IV - ÁREAS DE PRODUCCIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.AreaProduccion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            
                            if (inspection.InspAperFabricanteCosmetMed?.Acondicionamiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("V - ACONDICIONAMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.Acondicionamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.ControlCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("VI- CONTROL DE CALIDAD".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.ControlCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspAperFabricanteCosmetMed?.InspeccionAuditoria?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("VII- INSPECCIONES Y AUDITORÍA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto por evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperFabricanteCosmetMed.InspeccionAuditoria.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }


                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format(" ")).Bold();
                            //column.Item().AlignLeft().Text("El establecimiento se compromete a que los procedimientos operativos estandarizados (POE’S) y documentación relacionada a estos, estén completos y acorde con la Normativa vigente y según las actividades a las que se dedicará el establecimiento.  De igual forma el establecimiento deberá tener a disposición de la Autoridad Reguladora los procedimientos operativos estandarizados (POE’S) y documentación relacionada a estos cuando esta lo solicite y al momento de Auditoría de Buenas prácticas de Fabricación.");

                            if (!string.IsNullOrEmpty(inspection.InspAperFabricanteCosmetMed.DatosResponsable?.Firma))
                            {
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Firma del responsable del establecimiento:").Bold();
                                    if (!string.IsNullOrEmpty(inspection.InspAperFabricanteCosmetMed.DatosResponsable?.Firma))
                                    {
                                        //var bytes = Convert.FromBase64String(base64encodedstring);
                                        //var contents = new StreamContent(new MemoryStream(bytes));
                                        byte[] data = Convert.FromBase64String(inspection.InspAperFabricanteCosmetMed.DatosResponsable.Firma.Split("image/png;base64,")[1]);
                                        MemoryStream memoryStream = new MemoryStream(data);
                                        table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                    }
                                    else
                                    {
                                        table.Cell().AlignLeft().Padding(3).Text("");
                                    }
                                    table.Cell().ColumnSpan(2).AlignLeft().Padding(3).Text("");

                                    table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1}", inspection.InspAperFabricanteCosmetMed.DatosResponsable?.Nombre, inspection.InspAperFabricanteCosmetMed.DatosResponsable?.Cedula));

                                    table.Cell().ColumnSpan(2).AlignLeft().Padding(3).Text("");
                                });

                            }

                            //column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("PROCEDIMIENTOS OPERATIVOS ESTÁNDARES")).Bold();
                            //column.Item().AlignLeft().Text("El establecimiento se compromete a que los procedimientos operativos estandarizados (POE’S) y documentación relacionada a estos, estén completos y acorde con la Normativa vigente y según las actividades a las que se dedicará el establecimiento.  De igual forma el establecimiento deberá tener a disposición de la Autoridad Reguladora los procedimientos operativos estandarizados (POE’S) y documentación relacionada a estos cuando esta lo solicite y al momento de Auditoría de Buenas prácticas de Fabricación.");

                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("CRITERIO TÉCNICO")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Una vez evaluado el cumplimiento de los requerimientos previstos en el Decreto Ejecutivo 115 del 16 de agosto de 2022, por el cual se reglamentan las Buenas Prácticas de Fabricación de Productos Farmacéuticos.  Inspectores Farmacéuticos de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud de Panamá concluyen que el establecimiento denominado {0}, ubicado en {1}, {2} con los requisitos mínimos para operar como Laboratorio Farmacéutico dedicado a {3}. \r\nDado en la ciudad de Panamá a los {4} días del mes de {5} de {6}.", 
                                inspection.DatosEstablecimiento?.Nombre, 
                                inspection.DatosEstablecimiento?.Direccion, 
                                (inspection.DatosConclusiones.CumpleRequisitosMinOperacion ? "SÍ CUMPLE" : "NO CUMPLE"),
                                (inspection.InspAperFabricanteCosmetMed.ProdFabrican?.TipoProductos == enumTipoProductosImportacion.Otros ? (inspection.InspAperFabricanteCosmetMed.ProdFabrican?.ProductosDesc ?? "") : (inspection.InspAperFabricanteCosmetMed.ProdFabrican?.TipoProductos != enumTipoProductosImportacion.Otros ? DataModel.Helper.Helper.GetDescription(inspection.InspAperFabricanteCosmetMed?.ProdFabrican?.TipoProductos?? enumTipoProductosImportacion.Otros) : ""))  , 
                                inspection.DatosConclusiones?.FechaFinalizacion?.Day, 
                                Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.DatosConclusiones?.FechaFinalizacion?.ToString("MM") ?? "01")), 
                                inspection.DatosConclusiones?.FechaFinalizacion?.Year.ToString() ?? ""));

                            //column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("Inconformidades o desviaciones detectadas:")).Bold();
                            //column.Item().AlignLeft().Text(inspection.DatosConclusiones?.ObservacionesFinales??"");


                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspAperFabricanteCosmetMed.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperFabricanteCosmetMed.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspAperFabricanteCosmetMed.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperFabricanteCosmetMed.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", inspection.InspAperFabricanteCosmetMed.DatosRepresentLegal?.Nombre, inspection.InspAperFabricanteCosmetMed.DatosRepresentLegal?.Cedula, inspection.InspAperFabricanteCosmetMed.DatosRepresentLegal?.NumRegistro));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", inspection.InspAperFabricanteCosmetMed.DatosRegente?.Nombre, inspection.InspAperFabricanteCosmetMed.DatosRegente?.Cedula, inspection.InspAperFabricanteCosmetMed.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                            column.Item().PaddingVertical(5).AlignTop().Table(table => {
                                table.ColumnsDefinition(columns => {
                                    columns.RelativeColumn();
                                });

                                table.Header(header => {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Inconformidades o desviaciones detectadas".ToUpper()).Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch (Exception ex)
            { }
            return null;
        }
        //11 - Guis BPM Fabricante de Medicamentos
        private async Task<Stream> GenerateGuiaFabricantesMedicamentos(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");


                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("GUÍA DE VERIFICACIÓN DEL REGLAMENTO TECNICO CENTROAMERICANO RTCA 11.03.42:07 REGLAMENTO TÉCNICO SOBRE BUENAS PRÁCTICAS DE MANUFACTURA PARA LA INDUSTRIA FARMACÉUTICA. PRODUCTOS FARMACÉUTICOS Y MEDICAMENTOS DE USO HUMANO.".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento.TipoEstablecimiento)));
                            

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("I. INTRODUCCIÓN".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("El RTCA 11.03.42:07 Reglamento Técnico sobre Buenas Prácticas de Manufactura para la Industria Farmacéutica. Productos Farmacéuticos y Medicamentos de Uso Humano, establece que la verificación de su cumplimiento le corresponde a la Autoridad Reguladora de cada Estado Parte, lo que implica la revisión de todos los elementos relacionados con las BPM implementados en la industria, destinados a garantizar la producción de lotes uniformes de productos farmacéuticos con el fin de asegurar la calidad, seguridad y eficacia de los mismos."));
                            column.Item().AlignLeft().Text(string.Format("El presente documento consiste en el instrumento oficial para verificar el cumplimiento de las BPM en la industria farmacéutica, por parte de la Autoridad Reguladora de cada Estado Parte, con el cual se pretende homologar y armonizar los criterios de inspección y establecer una lista de puntos a verificar de todas las operaciones y procesos de la industria. Puede sertambién de utilidad para los laboratorios fabricantes en lo que respecta a la autoinspección."));
                            column.Item().AlignLeft().Text(string.Format("Cada ítem tiene asignada una calificación con la finalidad de que las inspecciones a realizar, respondan a criterios uniformes de evaluación, dichos criterios se definen en el glosario del presente documento"));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("II. OBJETIVO".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Establecer los criterios de evaluación a seguir por parte de la Autoridad Reguladora, para verificar el cumplimiento del RTCA 11.03.42:07Reglamento Técnico sobre Buenas Prácticas de Manufactura para la Industria Farmacéutica. Productos Farmacéuticos y Medicamentos de Uso Humano. "));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("III. ALCANCE".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Esta guía es de aplicación a todos los laboratorios farmacéuticos establecidos en el territorio de los Estados Parte."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("IV. DOCUMENTOS A CONSULTAR".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("El RTCA 11.03.42:07 Reglamento Técnico sobre Buenas Prácticas de Manufactura para la Industria Farmacéutica. Productos Farmacéuticos y Medicamentos de Uso Humano"));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("V. RESPONSABLE".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Autoridad Reguladora de cada Estado Parte."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("VI. GLOSARIO".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("CRITERIO CRÍTICO: aquel que en atención a las recomendaciones de las Buenas Prácticas de Manufactura, afecta en forma grave e inadmisible la calidad, seguridad de los productos y la seguridad de los trabajadores, en su interacción con los productos y procesos."));
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("CRITERIO MAYOR: aquel que en atención a las recomendaciones de las Buenas Prácticas de Manufactura, puede afectar en forma grave la calidad, seguridad de los productos y seguridad de los trabajadores, en su interacción con los productos y procesos."));
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("CRITERIO MENOR: aquel que en atención a las recomendaciones de las Buenas Prácticas de Manufactura, puede afectar en forma leve la calidad, seguridad de los productos y seguridad de los trabajadores, en su interacción con los productos y procesos."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("I. PARTICIPANTES EN LA INSPECCIÓN: ".ToUpper() + "(Informativo)")).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Autoridad Sanitaria:"));
                            if(inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}", participant.NombreCompleto));
                                }
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Por la Empresa:"));
                            if (inspection.InspGuiaBPMFabricanteMed?.DatosRepresentLegal != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Representante Legal: {0}, Cedula: {1}", inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal.Nombre, inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal.Cedula));
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.DatosRegente != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Regente farmacéutico / Director técnico y número de colegiado: {0}, Cedula: {1}", inspection.InspGuiaBPMFabricanteMed.DatosRegente.Nombre, inspection.InspGuiaBPMFabricanteMed.DatosRegente.Cedula));
                            }
                            
                            
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("II. GENERALIDADES: ".ToUpper() + "(Informativo)")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre de la empresa: {0}", inspection.DatosEstablecimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Provincia: {0}", inspection.DatosEstablecimiento?.Provincia?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Distrito: {0}", inspection.DatosEstablecimiento?.Distrito?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Corregimiento: {0}", inspection.DatosEstablecimiento?.Corregimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Dirección: {0}", inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Teléfono: {0}", inspection.DatosEstablecimiento?.Telefono));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.DatosEstablecimiento?.Correo));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE PRODUCCIÓN:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiaBPMFabricanteMed?.OtrosFuncionarios?.RespProduccion?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiaBPMFabricanteMed?.OtrosFuncionarios?.RespProduccion?.Profesion));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE CONTROL DE CALIDAD:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiaBPMFabricanteMed?.OtrosFuncionarios?.RespControlCalidad?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiaBPMFabricanteMed?.OtrosFuncionarios?.RespControlCalidad?.Profesion));

                            if (inspection.InspGuiaBPMFabricanteMed?.OtrosFuncionarios?.LPersona?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Otros funcionarios de la empresa:"));
                                foreach (var persona in inspection.InspGuiaBPMFabricanteMed.OtrosFuncionarios.LPersona)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}, Cargo: {1}", persona.Nombre, persona.Cargo));
                                }
                            }

                            if (inspection.InspGuiaBPMFabricanteMed?.RequisitosLegales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("REQUISITOS LEGALES:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.RequisitosLegales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                                                        
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Observaciones:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(inspection.InspGuiaBPMFabricanteMed.Observaciones);

                            column.Item().AlignLeft().Text(string.Format("¿Está el establecimiento sometido a un proceso periódico de vigilancia y control sanitario por la autoridad competente?"));
                            column.Item().AlignLeft().Text(string.Format(DataModel.Helper.Helper.GetDescription(inspection.InspGuiaBPMFabricanteMed.ProcesoVigilanciaSanit)));

                            column.Item().AlignLeft().Text(string.Format("Fecha de la última visita: {0} (Anexar copia de la hoja de la última inspección)", inspection.InspGuiaBPMFabricanteMed.FechaUltimaVista?.ToString("dd/MM/yyyy") ?? ""));

                            if (inspection.InspGuiaBPMFabricanteMed?.ClasifActComerciales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CLASIFICACIÓN DE LA ACTIVIDAD COMERCIAL:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.ClasifActComerciales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.ClasifEstablecimiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Clasificación del Establecimiento:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.ClasifEstablecimiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.OrganizacionPersonal?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ORGANIZACIÓN Y PERSONAL:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.OrganizacionPersonal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                   if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.EdifInstalaciones?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EDIFICIOS E INSTALACIONES. GENERALIDADES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.EdifInstalaciones.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.Almacenes?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EDIFICIOS E INSTALACIONES. ALMACENES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("MATERIA PRIMA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("MATERIAL ACONDICIONAMIENTO".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PRODUCTO A GRANEL".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PRODUCTO TERMINADO".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Inflamables".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PROD. y Mat. Rechazados".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Devoluciones".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.Almacenes.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(8).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(7).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.AreaDispMatPrima?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREA DE DISPENSADO DE MATERIA PRIMA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.AreaDispMatPrima.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.AreaProduccion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EDIFICIOS E INSTALACIONES. ALMACENES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("LÍQUIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEMISÓLIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SÓLIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.AreaProduccion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.AreaAcondicionamiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("ÁREAS DE ACONDICIONAMIENTO PARA EMPAQUE SECUNDARIO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.AreaAcondicionamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.EquiposGeneralidades?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EQUIPO. GENERALIDADES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("LÍQUIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEMISÓLIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SÓLIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.EquiposGeneralidades.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.Equipos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("ÁREAS DE ACONDICIONAMIENTO PARA EMPAQUE SECUNDARIO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.Equipos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.MatProducts?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("MATERIALES Y PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.MatProducts.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.Documentacion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Documentación".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.Documentacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.Produccion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("PRODUCCIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("LÍQUIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEMISÓLIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SÓLIDOS".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.Produccion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.GarantiaCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("GARANTÍA DE CALIDAD".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.GarantiaCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.ControlCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Control DE CALIDAD".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.ControlCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.ProdAnalisisContrato?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("PRODUCCIÓN Y ANÁLISIS POR CONTRATO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.ProdAnalisisContrato.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.ValGenerales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CALIFICACIÓN Y VALIDACIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.ValGenerales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.QuejasReclamos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("QUEJAS, RECLAMOS Y RETIRO DE PRODUCTOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.QuejasReclamos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.AutoInspecAuditCal?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("AUTOINSPECCIÓN Y AUDITORIAS DE CALIDAD".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.AutoInspecAuditCal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.FabProdFarmEsteril_A?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("FABRICACIÓN DE PRODUCTOS FARMACÉUTICOS ESTÉRILES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Esterilización Terminal".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Filtración esterilizante".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Llenado aséptico".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.FabProdFarmEsteril_A.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.FabProdFarmEsteril_Gen?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("FABRICACIÓN DE PRODUCTOS FARMACÉUTICOS ESTÉRILES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.FabProdFarmEsteril_Gen.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.FabProdFarmEsteril_A2?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("FABRICACIÓN DE PRODUCTOS FARMACÉUTICOS ESTÉRILES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Esterilización Terminal".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Filtración esterilizante".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Llenado aséptico".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.FabProdFarmEsteril_A2.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.FabProdFarmEsteril_A3?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("FABRICACIÓN DE PRODUCTOS FARMACÉUTICOS ESTÉRILES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.FabProdFarmEsteril_A3.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.Lactamicos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("FABRICACIÓN DE PRODUCTOS FARMACÉUTICOS β-LACTÁMICOS (Derivados Penicilínicos y Cefalosporínicos)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.Lactamicos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMFabricanteMed?.ProdCitostatico?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("FABRICACIÓN DE PRODUCTOS CON HORMONAS Y PRODUCTOS CITOSTÁTICOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMFabricanteMed.ProdCitostatico.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    if (!eva.HideEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                    else
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }


                            //column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            //{
                            //    table.ColumnsDefinition(columns =>
                            //    {
                            //        columns.RelativeColumn();
                            //    });

                            //    table.Header(header =>
                            //    {
                            //        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Observaciones".ToUpper()).Bold();
                            //    });

                            //    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            //});

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspGuiaBPMFabricanteMed.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiaBPMFabricanteMed.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal?.Nombre, inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal?.Cedula, inspection.InspGuiaBPMFabricanteMed.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspGuiaBPMFabricanteMed.DatosRegente?.Nombre, inspection.InspGuiaBPMFabricanteMed.DatosRegente?.Cedula, inspection.InspGuiaBPMFabricanteMed.DatosRegente?.Cargo, inspection.InspGuiaBPMFabricanteMed.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }

        //12 - Guis BPM Laboratorios Acondicionadores de Medicamentos
        private async Task<Stream> GenerateGuiaLabAcondicionadores(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("GUÍA de Laboratorio Acondicionador.".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento.TipoEstablecimiento)));
                            

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("I. PARTICIPANTES EN LA INSPECCIÓN: Informativo".ToUpper())).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Autoridad Sanitaria:"));
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}", participant.NombreCompleto));
                                }
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Por la Empresa:"));
                            if (inspection.InspGuiaBPMLabAcondicionador?.DatosRepresentLegal != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Representante Legal: {0}, Cedula: {1}", inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal.Nombre, inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal.Cedula));
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.DatosRegente != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Regente farmacéutico / Director técnico: {0}, Cedula: {1}", inspection.InspGuiaBPMLabAcondicionador.DatosRegente.Nombre, inspection.InspGuiaBPMLabAcondicionador.DatosRegente.Cedula));
                            }
                            

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("II. GENERALIDADES: Informativo".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre de la empresa: {0}", inspection.DatosEstablecimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Provincia: {0}", inspection.DatosEstablecimiento?.Provincia?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Distrito: {0}", inspection.DatosEstablecimiento?.Distrito?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Corregimiento: {0}", inspection.DatosEstablecimiento?.Corregimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Dirección: {0}", inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Teléfono: {0}", inspection.DatosEstablecimiento?.Telefono));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.DatosEstablecimiento?.Correo));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE PRODUCCIÓN:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiaBPMLabAcondicionador?.OtrosFuncionarios?.RespProduccion?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiaBPMLabAcondicionador?.OtrosFuncionarios?.RespProduccion?.Profesion));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE CONTROL DE CALIDAD:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiaBPMLabAcondicionador?.OtrosFuncionarios?.RespControlCalidad?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiaBPMLabAcondicionador?.OtrosFuncionarios?.RespControlCalidad?.Profesion));

                            if (inspection.InspGuiaBPMLabAcondicionador?.OtrosFuncionarios?.LPersona?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Otros funcionarios de la empresa:"));
                                foreach (var persona in inspection.InspGuiaBPMLabAcondicionador.OtrosFuncionarios.LPersona)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}, Cargo: {1}", persona.Nombre, persona.Cargo));
                                }
                            }

                            if (inspection.InspGuiaBPMLabAcondicionador?.RequisitosLegales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("REQUISITOS LEGALES:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.RequisitosLegales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Observaciones:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(inspection.InspGuiaBPMLabAcondicionador.Observaciones);

                            column.Item().AlignLeft().Text(string.Format("¿Está el establecimiento sometido a un proceso periódico de vigilancia y control sanitario por la autoridad competente?"));
                            column.Item().AlignLeft().Text(string.Format(DataModel.Helper.Helper.GetDescription(inspection.InspGuiaBPMLabAcondicionador.ProcesoVigilanciaSanit)));

                            column.Item().AlignLeft().Text(string.Format("Fecha de la última visita: {0} (Anexar copia de la hoja de la última inspección)", inspection.InspGuiaBPMLabAcondicionador.FechaUltimaVista?.ToString("dd/MM/yyyy") ?? ""));

                            if (inspection.InspGuiaBPMLabAcondicionador?.ClasifActComerciales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CLASIFICACIÓN DE LA ACTIVIDAD COMERCIAL: ".ToUpper() + "Informativo")).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.ClasifActComerciales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.ClasifEstablecimiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Clasificación del Establecimiento: ".ToUpper() + "Informativo")).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.ClasifEstablecimiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.OrganizacionPersonal?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("7. ORGANIZACIÓN Y PERSONAL:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.OrganizacionPersonal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.EdifInstalaciones?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EDIFICIOS E INSTALACIONES. GENERALIDADES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.EdifInstalaciones.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.Almacenes?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EDIFICIOS E INSTALACIONES. ALMACENES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("MATERIAL ACONDICIONAMIENTO".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PRODUCTO TERMINADO".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PROD. y Mat. Rechazados".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Devoluciones".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.Almacenes.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(6).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.AreaAcondicionamiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("EDIFICIOS E INSTALACIONES. Otras Áreas".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.AreaAcondicionamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.EquiposGeneralidades?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("9. Equipo".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.EquiposGeneralidades.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.MatProducts?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("10. Materiales y Productos".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.MatProducts.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.Documentacion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("11. Documentación".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.Documentacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.Acondicionamiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("12. Acondicionamiento".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.Acondicionamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.GarantiaCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("13. Garantía de Calidad".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.GarantiaCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.ControlCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("14. Control de Calidad".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.ControlCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.ProdAnalisisContrato?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("15. Producción y Análisis por Contrato".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.ProdAnalisisContrato.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.ValGenerales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("16. Validación".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.ValGenerales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.QuejasReclamos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("17. Quejas, Reclamos y Retiros de Productos".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.QuejasReclamos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPMLabAcondicionador?.AutoInspecAuditCal?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("18. AutoInspección y Auditorías de Calidad".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPMLabAcondicionador.AutoInspecAuditCal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }


                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Observaciones".ToUpper()).Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspGuiaBPMLabAcondicionador.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiaBPMLabAcondicionador.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal?.Nombre, inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal?.Cedula, inspection.InspGuiaBPMLabAcondicionador.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspGuiaBPMLabAcondicionador.DatosRegente?.Nombre, inspection.InspGuiaBPMLabAcondicionador.DatosRegente?.Cedula, inspection.InspGuiaBPMLabAcondicionador.DatosRegente?.Cargo, inspection.InspGuiaBPMLabAcondicionador.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //13 - BPM Guia Fabricante de Cosmeticos y Desinfectantes
        private async Task<Stream> GenerateGuiaFabricantesCosmeticosDesinfectantes(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("Guía de Laboratorio Fabricante de Fabricantes Cosmeticos Desinfectantes y Plaguicidas".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");


                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento.TipoEstablecimiento)));
                            
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("I. PARTICIPANTES EN LA INSPECCIÓN:".ToUpper() + " (Informativo)")).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Autoridad Sanitaria:"));
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}", participant.NombreCompleto));
                                }
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Por la Empresa:"));
                            if (inspection.InspGuiBPMFabCosmeticoMed?.DatosRepresentLegal != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Representante Legal: {0}, Cedula: {1}", inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal.Nombre, inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal.Cedula));
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.DatosRegente != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Regente farmacéutico / Director técnico: {0}, Cedula: {1}", inspection.InspGuiBPMFabCosmeticoMed.DatosRegente.Nombre, inspection.InspGuiBPMFabCosmeticoMed.DatosRegente.Cedula));
                            }
                            

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("II. GENERALIDADES:".ToUpper() + " (Informativo)")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre de la empresa: {0}", inspection.DatosEstablecimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Provincia: {0}", inspection.DatosEstablecimiento?.Provincia?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Distrito: {0}", inspection.DatosEstablecimiento?.Distrito?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Corregimiento: {0}", inspection.DatosEstablecimiento?.Corregimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Dirección: {0}", inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Teléfono: {0}", inspection.DatosEstablecimiento?.Telefono));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.DatosEstablecimiento?.Correo));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE PRODUCCIÓN:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiBPMFabCosmeticoMed?.OtrosFuncionarios?.RespProduccion?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiBPMFabCosmeticoMed?.OtrosFuncionarios?.RespProduccion?.Profesion));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE CONTROL DE CALIDAD:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiBPMFabCosmeticoMed?.OtrosFuncionarios?.RespControlCalidad?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiBPMFabCosmeticoMed?.OtrosFuncionarios?.RespControlCalidad?.Profesion));

                            if (inspection.InspGuiBPMFabCosmeticoMed?.OtrosFuncionarios?.LPersona?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Otros funcionarios de la empresa:"));
                                foreach (var persona in inspection.InspGuiBPMFabCosmeticoMed.OtrosFuncionarios.LPersona)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}, Cargo: {1}", persona.Nombre, persona.Cargo));
                                }
                            }

                            if (inspection.InspGuiBPMFabCosmeticoMed?.RequisitosLegales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("REQUISITOS LEGALES:".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.RequisitosLegales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                        }
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Observaciones:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(inspection.InspGuiBPMFabCosmeticoMed.Observaciones);

                            column.Item().AlignLeft().Text(string.Format("¿Está el establecimiento sometido a un proceso periódico de vigilancia y control sanitario por la autoridad competente?"));
                            column.Item().AlignLeft().Text(string.Format(DataModel.Helper.Helper.GetDescription(inspection.InspGuiBPMFabCosmeticoMed.ProcesoVigilanciaSanit)));

                            column.Item().AlignLeft().Text(string.Format("Fecha de la última visita: {0} (Anexar copia de la hoja de la última inspección)", inspection.InspGuiBPMFabCosmeticoMed.FechaUltimaVista?.ToString("dd/MM/yyyy") ?? ""));

                            if (inspection.InspGuiBPMFabCosmeticoMed?.ClasifActComerciales?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CLASIFICACIÓN DE LA ACTIVIDAD COMERCIAL - Informativo".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        //columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper()).Bold(); ;
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.ClasifActComerciales.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold(); ;
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold(); ;
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold(); ;
                                            //table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.ClasifEstablecimiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Clasificación del Establecimiento - Informativo".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper()).Bold();
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        //header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.ClasifEstablecimiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AdminInfoGeneral?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO I - ADMINISTRACIÓN E INFORMACIÓN GENERAL".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AdminInfoGeneral.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold(); ;
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);

                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.CondExtAlmacenas?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO II - ALMACENES".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.CondExtAlmacenas.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.CondIntAlmacenas?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Condiciones Internas".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.CondIntAlmacenas.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaRecepMateriaPrima?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de Recepción de Materia Prima".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaRecepMateriaPrima.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AlmacenMateriaPrima?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Almacén de Materia Prima".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AlmacenMateriaPrima.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AlmacenMatAcondicionamineto?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de almacenamiento de Materiales de Acondicionamiento, Empaque y Envase".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AlmacenMatAcondicionamineto.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.RecepProductoTerminado?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Recepción de Producto Terminado (de producción al almacén)".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.RecepProductoTerminado.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AlmacenProductoTerminado?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Almacén de Producto Terminado".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AlmacenProductoTerminado.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.ProductoDevueltoRechazado?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de productos Devueltos y/o Rechazados".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.ProductoDevueltoRechazado.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.DistProductoTerminado?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Distribución de Productos Terminados".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.DistProductoTerminado.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.ManejoQuejaReclamos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Manejo de quejas y reclamos de productos comercializados".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.ManejoQuejaReclamos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.RetiroProcMercado?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Retiro de Productos del Mercado".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.RetiroProcMercado.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.SistemaInstAgua?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO III-SISTEMAS CRÍTICOS DE APOYO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.SistemaInstAgua.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.OsmosisInversa?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Osmosis Inversa".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.OsmosisInversa.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.SistemaDeIonizacion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Sistema de Deionización".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.SistemaDeIonizacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.CalibraVerifEquipo?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Calibraciones y Verificaciones de equipo".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.CalibraVerifEquipo.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.Validaciones?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Validaciones".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.Validaciones.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.MantAreaEquipos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Mantenimiento de áreas y equipos".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.MantAreaEquipos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaProdCondExternas?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO IV - ÁREAS DE PRODUCCIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaProdCondExternas.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaProdCondInternas?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Condiciones Internas".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaProdCondInternas.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaOrganizaDocumentacion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Organización y Documentación".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaOrganizaDocumentacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaDispensionOrdFab?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de Dispensación de Ordenes de Fabricación".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaDispensionOrdFab.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.FabProdDesinfectante?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Fabricación de Productos Desinfectantes".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.FabProdDesinfectante.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.FabPlaguicida?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Fabricación de Plaguicidas".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.FabPlaguicida.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.FabCosmeticos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Fabricación de Cosméticos".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.FabCosmeticos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaEnvasado?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO V - ACONDICIONAMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaEnvasado.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AreaEtiquetadoEmpaque?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Área de Etiquetado y Empaque".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AreaEtiquetadoEmpaque.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.LabControlCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO VI - CONTROL DE CALIDAD".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.LabControlCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.AnalisisContrato?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.AnalisisContrato.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabCosmeticoMed?.InspeccionAudito?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CAPITULO VII - INSPECCIONES Y AUDITORÍA".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Max".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Pto. Obt".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Art.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Eval.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Crit.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabCosmeticoMed.InspeccionAudito.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("").Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax>0? dat.PuntosMax:"");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.PuntosMax > 0 ? dat.PuntosObtenido : "");
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            if (dat.LSubPreguntas?.Count > 0)
                                            {
                                                foreach (var eva in dat.LSubPreguntas)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(eva.Nombre);
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                                }
                                            }
                                        }
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspGuiBPMFabCosmeticoMed.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiBPMFabCosmeticoMed.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal?.Nombre, inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal?.Cedula, inspection.InspGuiBPMFabCosmeticoMed.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspGuiBPMFabCosmeticoMed.DatosRegente?.Nombre, inspection.InspGuiBPMFabCosmeticoMed.DatosRegente?.Cedula, inspection.InspGuiBPMFabCosmeticoMed.DatosRegente?.Cargo, inspection.InspGuiBPMFabCosmeticoMed.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //14 - Guia BPM Fabricante Productos Naturales Medicinales
        private async Task<Stream> GenerateGuiaFabricantesProdNaturalesMedicinales(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignRight().Text("Anexo de la Resolución No. 423-2020(COMIECO-XC)").Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignCenter().Text("GUÍA DE VERIFICACIÓN DEL REGLAMENTO TÉCNICO CENTROAMERICANO (RTCA) 11.03.69:13 PRODUCTOS FARMACÉUTICOS. PRODUCTOS NATURALES MEDICINALES PARA USO HUMANO. BUENAS PRÁCTICAS DE MANUFACTURA".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");


                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("CRITERIOS DE EVALUACIÓN:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Los diferentes ítems a evaluar de la Guía de Verificación de Buenas Prácticas de Manufactura (BPM) de Productos Naturales Medicinales para uso Humano, se clasificarán como críticos, calificables e informativos."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("CRÍTICO:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Es aquel que, en atención a las BPM, afecta en forma grave e inadmisible la calidad y /o seguridad de los productos y la seguridad de los trabajadores, en su interacción con los productos y procesos."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("CALIFICABLE:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Aquellos ítems que no son considerados como críticos, pero deben ser evaluados y valorados para el cumplimiento del presente reglamento"));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("INFORMATIVO:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Suministra información de la organización y aspectos relacionados con las BPM, pero no afecta la calidad ni la seguridad de los productos o de los trabajadores en su interacción con los productos y procesos. No se contabiliza para el puntaje total."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Los criterios CRÍTICOS y CALIFICABLES se calificarán como cumple (100%), no cumple (0%) o no aplica, según corresponda"));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("CRITERIOS PARA LA EMISIÓN DEL CERTIFICADO DE BUENAS PRÁCTICAS DE MANUFACTURA".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Para la emisión del certificado de Buenas Prácticas de Manufactura (BPM) el laboratorio debe obtener un porcentaje de cumplimiento del 95% al 100% para los criterios calificados como críticos y un mínimo del 80 % de los ítems clasificados como calificables en la guía de verificación. Para alcanzar el 100% de cumplimiento para todas las no conformidades críticas y calificables, el laboratorio debe presentar un plan de mejora cuyos plazos de cumplimiento serán aprobados por la autoridad reguladora, según el riesgo sanitario y verificado en inspecciones posteriores. De no cumplir los plazos establecidos en el plan de mejora, se cancelará el certificado de BPM."));

                            column.Item().AlignLeft().Text(string.Format("El plan de mejora se deberá presentar en el plazo que defina la autoridad reguladora, posterior a la entrega del Informe de no conformidades detectadas durante la evaluación técnica"));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("NOTAS:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("1) Para el caso de Guatemala y Panamá, el plazo será de 30 días calendario. El incumplimiento a esta disposición será objeto de la sanción correspondiente."));
                            column.Item().AlignLeft().Text(string.Format("2) Para el caso de Honduras, deberán presentar el plan de mejora en los plazos establecidos, pero este no estará sujeto a la aprobación por parte de la autoridad reguladora."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("VIGENCIA DEL CERTIFICADO DE BUENAS PRÁCTICAS DE MANUFACTURA (BPM)".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("El certificado de BPM tendrá una vigencia de 2 años, esto no exime que la autoridad reguladora desarrolle auditorías durante el período de vigencia."));


                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("I. PARTICIPANTES EN LA INSPECCIÓN:".ToUpper())).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Autoridad Sanitaria:"));
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}", participant.NombreCompleto));
                                }
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Por la Empresa:"));
                            if (inspection.InspGuiBPMFabNatMedicina?.DatosRepresentLegal != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Representante Legal: {0}, Cedula: {1}", inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal.Nombre, inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal.Cedula));
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.DatosRegente != null)
                            {
                                column.Item().AlignLeft().Text(string.Format("Regente farmacéutico / Director técnico: {0}, Cedula: {1}", inspection.InspGuiBPMFabNatMedicina.DatosRegente.Nombre, inspection.InspGuiBPMFabNatMedicina.DatosRegente.Cedula));
                            }
                            

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("II. GENERALIDADES:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre de la empresa: {0}", inspection.DatosEstablecimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Provincia: {0}", inspection.DatosEstablecimiento?.Provincia?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Distrito: {0}", inspection.DatosEstablecimiento?.Distrito?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Corregimiento: {0}", inspection.DatosEstablecimiento?.Corregimiento?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Dirección: {0}", inspection.DatosEstablecimiento?.Direccion));
                            column.Item().AlignLeft().Text(string.Format("Teléfono: {0}", inspection.DatosEstablecimiento?.Telefono));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.DatosEstablecimiento?.Correo));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE PRODUCCIÓN:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiBPMFabNatMedicina?.OtrosFuncionarios?.RespProduccion?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiBPMFabNatMedicina?.OtrosFuncionarios?.RespProduccion?.Profesion));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("RESPONSABLE DE CONTROL DE CALIDAD:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre: {0}", inspection.InspGuiBPMFabNatMedicina?.OtrosFuncionarios?.RespControlCalidad?.Nombre));
                            column.Item().AlignLeft().Text(string.Format("Profesión: {0}", inspection.InspGuiBPMFabNatMedicina?.OtrosFuncionarios?.RespControlCalidad?.Profesion));

                            if (inspection.InspGuiBPMFabNatMedicina?.OtrosFuncionarios?.LPersona?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Otros funcionarios de la empresa:"));
                                foreach (var persona in inspection.InspGuiBPMFabNatMedicina.OtrosFuncionarios.LPersona)
                                {
                                    column.Item().AlignLeft().Text(string.Format("Lic. {0}, Cargo: {1}", persona.Nombre, persona.Cargo));
                                }
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.InfoGeneral?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Información General".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.InfoGeneral.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AuthFuncionamiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 5".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AuthFuncionamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Organizacion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Organizacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Personal?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Personal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.ResponPersonal?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ResponPersonal.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Capacitacion?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Capacitacion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.HigieneSalud?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.HigieneSalud.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.UbicacionDisenoConstruc?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 7".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.UbicacionDisenoConstruc.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Almacenes?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Almacenes.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaRecepLimpieza?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaRecepLimpieza.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaSecadoMolienda?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaSecadoMolienda.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaDispensadoMatPrima?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaDispensadoMatPrima.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaProduccion?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaProduccion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaEnvasadoEmpaque?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaEnvasadoEmpaque.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaAuxiliares?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaAuxiliares.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.AreaControlCalidad?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AreaControlCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades8?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 8".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades8.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Calibracion?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Calibracion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.SistemaAgua?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.SistemaAgua.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.SistemaAire?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.SistemaAire.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades9?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 9".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades9.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.DispensadoMatPrima?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.DispensadoMatPrima.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.MatAcondicionamiento?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.MatAcondicionamiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.ProdAGranel?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ProdAGranel.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.ProdTerminados?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ProdTerminados.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.ProdRechazados?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ProdRechazados.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.ProdDevueltos?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ProdDevueltos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades10?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 11".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades10.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.DocumentosExigido?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.DocumentosExigido.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.ProcedimientoReg?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ProcedimientoReg.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.ProdControlProceso?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 11".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.ProdControlProceso.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                           table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades12?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 12".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades12.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.GarantiaCalidad?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.GarantiaCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades13?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 13".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades13.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Muestreo?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Muestreo.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.MetodologiaAnalitica?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.MetodologiaAnalitica.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.MaterialesReferencia?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.MaterialesReferencia.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Estabilidad?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Estabilidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades14?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 14".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades14.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Retiros?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Retiros.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.Generalidades15?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 15".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Generalidades15.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Contratante?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Contratante.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiBPMFabNatMedicina?.Contratista?.LContenido?.Count > 0)
                            {
                                //column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                //column.Item().AlignLeft().Text(string.Format("Capítulo 6".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.Contratista.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            if (inspection.InspGuiBPMFabNatMedicina?.AuditoriaCalidad?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Capítulo 16".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Capítulo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Artículo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumple".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiBPMFabNatMedicina.AuditoriaCalidad.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo).Bold();
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }


                            //column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            //{
                            //    table.ColumnsDefinition(columns =>
                            //    {
                            //        columns.RelativeColumn();
                            //    });

                            //    table.Header(header =>
                            //    {
                            //        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Observaciones".ToUpper()).Bold();
                            //    });

                            //    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            //});

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                if (!string.IsNullOrEmpty(inspection.InspGuiBPMFabNatMedicina.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiBPMFabNatMedicina.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal?.Nombre, inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal?.Cedula, inspection.InspGuiBPMFabNatMedicina.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspGuiBPMFabNatMedicina.DatosRegente?.Nombre, inspection.InspGuiBPMFabNatMedicina.DatosRegente?.Cedula, inspection.InspGuiBPMFabNatMedicina.DatosRegente?.Cargo, inspection.InspGuiBPMFabNatMedicina.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }
        //15 -generamos el pdf de BPM Guia BPA
        private async Task<Stream> GenerateGuiaBPM_BPA(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("Guía para las Buenas Prácticas de Almacenamiento, Distribución y Transporte de Medicamentos y Otros Productos para la Salud Humana".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().PaddingVertical(5).AlignCenter().Text("ANEXO");

                            column.Item().AlignLeft().Text("ÍNDICE\r\n");
                            column.Item().PaddingVertical(5).AlignLeft().Text("I. INTRODUCCIÓN.\r\nII. CLASIFICACIÓN DE LOS CRITERIOS DE EVALUACIÓN\r\nIII. CRITERIO DE APROBACIÓN\r\nIV. SOLICITUD PARA OBTENCIÓN DEL CERTIFICADO DE BUENAS PRÁCTICAS DE\r\n ALMACENAMIENTO Y DISTRIBUCIÓN\r\nV. DATOS GENERALES DEL ESTABLECIMIENTO Y DE LA INSPECCIÓN\r\n\r\n1.DISPOSICIONES GENERALES DEL ESTABLECIMIENTO FARMACÉUTICO  \r\n1.1. Generalidades\r\n1.2. Documentación\r\n2.AREAS DEL ESTABLECIMIENTO\r\n2.1. Instalaciones\r\n2.2. Área de Recepción y Despacho\r\n2.3. Área de Almacén\r\n2.4. Almacenamiento de Productos\r\n       de Cadena de Frío\r\n2.5. Almacenamiento de\r\n       Estupefacientes o psicotrópicos\r\n2.6. Productos inflamables\r\n2.7. Plaguicidas\r\n2.8. Cosméticos\r\n2.9. Materia prima para la fabricación de productos regulados por la Dirección Nacional de Farmacia y Drogas  \r\n2.10. Productos retirados del mercado\r\n2.11. Productos devueltos del mercado\r\n2.12. Productos Falsificados o Ilícitos\r\n3. DISTRIBUCIÓN  \r\n3.1. Especificaciones para Productos a Distribuir\r\n3.2. Registros de Distribución\r\n4.DEL TRANSPORTE PARA LOS PRODUCTOS FARMACÉUTICOS\r\n5. AUTO-INSPECCIÓN\r\n6. CONCLUSIONES");

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("I. INTRODUCCIÓN".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Con el propósito de establecer un documento oficial utilizado como apoyo en la realización de las inspecciones por parte de la Autoridad Reguladora y en el proceso de autoinspección en cada establecimiento farmacéutico que se dedica al Almacenamiento, Distribución y Transporte de Medicamentos y otros Productos para la Salud Humana, la Dirección Nacional de Farmacia y Drogas presenta el documento denominado Guía de Buenas Prácticas de Almacenamiento, Distribución y Transporte de Medicamentos y Otros Productos para la Salud Humana."));
                            column.Item().AlignLeft().Text(string.Format("Los ítems contemplados en la presente Guía se sustentan en la Ley No. 1 de 10 de enero de 2001 sobre Medicamentos y Otros Productos para la Salud Humana, en el Título III de la Comercialización, Capítulo I, artículo 67 y su Reglamentación contempladas en el Decreto Ejecutivo N° 115 de 16 de agosto de 2022 que reglamenta la Ley N° 1 sobre Medicamentos y Otros Productos para la Salud Humana."));
                            column.Item().AlignLeft().Text(string.Format("La Autoridad de Salud, realizará inspecciones para la evaluación de las Buenas Prácticas de Almacenamiento, Distribución y Transporte de Medicamentos y otros Productos para la Salud Humana, y al final levanta un acta de lo actuado.  Según los resultados se procederá a emitir la certificación correspondiente o en su defecto podrá amonestar, sancionar, retener o decomisar mediante resolución motivada lo que corresponda.  Por tanto, todo establecimiento farmacéutico que se dedica al Almacenamiento, Distribución y Transporte de Medicamentos y otros productos competencia de la Dirección Nacional de Farmacia y Drogas queda sujeto a inspecciones periódicas por parte de la Autoridad Reguladora."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("II. CLASIFICACIÓN DE LOS CRITERIOS DE EVALUACIÓN".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("CRITERIO CRÍTICO: aquel que en atención a la normativa vigente sobre las Buenas Prácticas de Almacenamiento y Distribución (BPA y BPD) establecidas en la República de Panamá, su no cumplimiento afecta en forma grave e inadmisible la calidad, seguridad de los productos."));
                            column.Item().AlignLeft().Text(string.Format("CRITERIO MAYOR: aquel que en atención a la normativa vigente sobre las Buenas Prácticas de Almacenamiento y Distribución (BPA y BPD) establecidas en la República de Panamá, su no cumplimiento puede afectar en forma grave la calidad, seguridad de los productos."));
                            column.Item().AlignLeft().Text(string.Format("CRITERIO MENOR: aquel que en atención a la normativa vigente sobre las Buenas Prácticas de Almacenamiento y Distribución (BPA y BPD) establecidas en la República de Panamá, su no cumplimiento puede afectar en forma leve la calidad de los productos o puede ser sólo un tema de forma."));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("III. CRITERIO DE APROBACIÓN".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Para aprobar el cumplimiento de las Buenas Prácticas de Almacenamiento y distribución establecidas en el Decreto Ejecutivo Nº 115 del 16 de agosto de 2022, la Agencia Distribuidora debe cumplir con los porcentajes mínimos establecidos en la normativa vigente"));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("IV. SOLICITUD PARA OBTENCIÓN DEL CERTIFICADO DE BUENAS PRÁCTICAS DE ALMACENAMIENTO Y DISTRIBUCIÓN".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("el interesado debe realizar la solicitud con el formulario destinado para tal fin"));

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("V. DATOS GENERALES DEL ESTABLECIMIENTO".ToUpper())).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Establecimiento Farmacéutico")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Nombre de la empresa: {0}", inspection.DatosEstablecimiento?.Nombre??""));
                            column.Item().AlignLeft().Text(string.Format("Provincia: {0}", inspection.DatosEstablecimiento?.Provincia?.Nombre??""));
                            column.Item().AlignLeft().Text(string.Format("Distrito: {0}", inspection.DatosEstablecimiento?.Distrito?.Nombre ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Corregimiento: {0}", inspection.DatosEstablecimiento?.Corregimiento?.Nombre ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Teléfono Fijo: {0}", inspection.DatosEstablecimiento?.Telefono ?? ""));
                            //column.Item().AlignLeft().Text(string.Format("Móvil: {0}",""));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.DatosEstablecimiento?.Correo ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Licencia de Operación Nº:  {0}", inspection.DatosEstablecimiento?.NumLicencia ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Fecha de Expiración:  {0}", inspection.DatosEstablecimiento?.VigenteHasta?.ToString("dd/MM/yyyy") ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Licencia Especial de Sustancias Controladas Nº:  {0}", inspection.InspGuiaBPM_Bpa.LicEspSustanciasCtr));
                            column.Item().AlignLeft().Text(string.Format("Fecha de Expiración:  {0}", inspection.InspGuiaBPM_Bpa?.FechaExpLicEspecial?.ToString("dd/MM/yyyy") ?? ""));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Actividad Comercial aprobada (Ley 1 Art. 172):")).Bold();
                            column.Item().AlignLeft().Text(string.Format("{0}", inspection.InspGuiaBPM_Bpa.ActComercialAprobada));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Regente Farmacéutico")).Bold();
                            column.Item().AlignLeft().Text(string.Format("{1}: {0}", inspection.InspGuiaBPM_Bpa.DatosRegente?.Nombre??"", inspection.InspGuiaBPM_Bpa.DatosRegente?.Cargo ?? ""));
                            column.Item().AlignLeft().Text(string.Format("N° Idoneidad: {0}", inspection.InspGuiaBPM_Bpa.DatosRegente?.NumRegistro ?? ""));
                            //column.Item().AlignLeft().Text(string.Format("Móvil: {0}", inspection.InspGuiaBPM_Bpa.DatosRegente?.TelefonoMovil ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Teléfono: {0}", inspection.InspGuiaBPM_Bpa.DatosRegente?.TelefonoMovil ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.InspGuiaBPM_Bpa.DatosRegente?.Email ?? ""));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Representante Legal")).Bold();
                            column.Item().AlignLeft().Text(string.Format("{1}: {0}", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Nombre ?? "", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Cargo ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Cédula: {0}", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Cedula ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Teléfono: {0}", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.TelefonoMovil ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Correo electrónico: {0}", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Email ?? ""));
                            column.Item().AlignLeft().Text(string.Format("Dirección completa del Domicilio: {0}", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Ubicacion ?? ""));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Fecha de la última Inspección por BPAD Oficial realizada: {0}", inspection.InspGuiaBPM_Bpa.FechaUltimaInspeccion?.ToString("dd/MM/yyyy") ?? ""));

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("DATOS GENERALES DE LA INSPECCIÓN".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Propósito de la Inspección de Buenas Prácticas de Almacenamiento y Distribución")).Bold();
                            if(inspection.InspGuiaBPM_Bpa?.PropositoInsp?.LPropositos?.Count > 0)
                            {
                                foreach (var propos in inspection.InspGuiaBPM_Bpa.PropositoInsp.LPropositos)
                                {
                                    column.Item().AlignLeft().Text(string.Format("{0}", propos.Nombre));
                                }
                            }
                            

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Participantes de la inspección:".ToUpper())).Bold();

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Dirección Nacional de Farmacia y Drogas:"));
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)4);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nombre".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cargo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Registro de Idoneidad".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Area Evaluada".ToUpper());
                                    });
                                    foreach (var dat in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.NombreCompleto);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.Cargo);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.RegistroNumero);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.AreaEvaluada);
                                    }
                                });
                            }
                                
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Por el Establecimiento:"));
                            if (inspection.InspGuiaBPM_Bpa?.OtrosFuncionarios?.LPersona?.Count > 0)
                            {
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)4);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Nombre".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cargo".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Registro de Idoneidad".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Area Evaluada".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPM_Bpa.OtrosFuncionarios.LPersona)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.Cargo);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.NumRegistro);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignCenter().Padding(3).Text(dat.AreaEvaluada);
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Horarios verificados durante la inspección:")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Establecimiento Farmacéutico:\r\n {0}", inspection.InspGuiaBPM_Bpa.HorarioEstFarmaceutico));
                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Regencia Farmacéutica:\r\n {0}", inspection.InspGuiaBPM_Bpa.HorarioRegFarmaceutica));

                            if (inspection.InspGuiaBPM_Bpa?.DispGenerlestablecimiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("1. DISPOSICIONES GENERALES DEL ESTABLECIMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("No.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("D.E. 115".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Otros".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Evaluación".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVIDENCIAS / OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPM_Bpa.DispGenerlestablecimiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero>0? dat.Numero:"").Bold();
                                            table.Cell().ColumnSpan(6).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPM_Bpa?.AreasEstablecimiento?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("2. AREAS DEL ESTABLECIMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("No.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("D.E. 115".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Otros".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Evaluación".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVIDENCIAS / OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPM_Bpa.AreasEstablecimiento.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero > 0 ? dat.Numero : "").Bold();
                                            table.Cell().ColumnSpan(6).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPM_Bpa?.Distribucion?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("3. DISTRIBUCIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("No.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("D.E. 115".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Otros".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Evaluación".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVIDENCIAS / OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPM_Bpa.Distribucion.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero > 0 ? dat.Numero : "").Bold();
                                            table.Cell().ColumnSpan(6).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPM_Bpa?.TransProdFarmaceuticos?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("4. TRANSPORTE PARA LOS PRODUCTOS FARMACÉUTICOS".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("No.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("D.E. 115".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Otros".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Evaluación".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVIDENCIAS / OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPM_Bpa.TransProdFarmaceuticos.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero > 0 ? dat.Numero : "").Bold();
                                            table.Cell().ColumnSpan(6).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspGuiaBPM_Bpa?.AutoInspec?.LContenido?.Count > 0)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("5. AUTO-INSPECCIÓN".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("No.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Título".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Criterio".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("D.E. 115".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Otros".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Evaluación".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVIDENCIAS / OBSERVACIONes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspGuiaBPM_Bpa.AutoInspec.LContenido)
                                    {
                                        if (dat.IsHeader)
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero > 0 ? dat.Numero : "").Bold();
                                            table.Cell().ColumnSpan(6).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else
                                        {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Criterio);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Capitulo);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Articulo);
                                            if (dat.LEvaluacion?.Count > 0)
                                            {
                                                foreach (var eva in dat.LEvaluacion)
                                                {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text("6. CONCLUSIONES:".ToUpper()).Bold();
                            column.Item().AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Observaciones".ToUpper()).Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            //column.Item().PaddingVertical(5).Text("CONCLUSIONES:\r\nObservaciones".ToUpper()).Bold();
                            //column.Item().Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            column.Item().PaddingVertical(5).Text(string.Format("Se culmina la Inspección por Verificación del cumplimiento de las Buenas Prácticas de Almacenamiento, Distribución y Transporte a las {0}, del día {1} de {2} de {3}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("hh:mm tt"), inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd"), Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.DatosConclusiones?.FechaFinalizacion?.ToString("MM")??"0")), inspection.DatosConclusiones?.FechaFinalizacion?.ToString("yyyy")));


                            column.Item().PaddingVertical(5).Text(string.Format("Declaro que he participado en la Inspección del Establecimiento Farmacéutico y se ha verificado cada uno de los puntos aplicables y descritos en la presente guía.\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text(string.Format("Por el Establecimiento denominado {0} con licencia No {1}", inspection.DatosEstablecimiento?.Nombre ?? "", inspection.DatosEstablecimiento?.NumLicencia ?? "")).Bold();
                                if (!string.IsNullOrEmpty(inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiaBPM_Bpa.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }

                                if (!string.IsNullOrEmpty(inspection.InspGuiaBPM_Bpa.DatosRegente?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspGuiaBPM_Bpa.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Nombre, inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Cedula, inspection.InspGuiaBPM_Bpa.DatosRepresentLegal?.Cargo));
                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspGuiaBPM_Bpa.DatosRegente?.Nombre, inspection.InspGuiaBPM_Bpa.DatosRegente?.Cedula, inspection.InspGuiaBPM_Bpa.DatosRegente?.Cargo, inspection.InspGuiaBPM_Bpa.DatosRegente?.NumRegistro));

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                       header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold(); 
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                   tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch (Exception ex)
            { }
            return null;
        }
        //16 - Apertura – Cosméticos Artesanales
        private async Task<Stream> GenerateAperturaCosmeticosArtesanales(AUD_InspeccionTB inspection)
        {
            try {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container => {
                    container.Page(page => {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));
                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");


                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE AUDITORíAS\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                            table.Cell().ColumnSpan(3).AlignLeft().Text(" ");

                            table.Cell().AlignLeft().Text(string.Format("Fecha de Evaluación {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            table.Cell().AlignLeft().AlignLeft().Text(" ");
                            table.Cell().AlignRight().Text(string.Format("Hora de Inicio {0}", inspection.FechaInicio.ToString("hh:mm tt")));


                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("Evaluación Técnica por Apertura para la Elaboración de Cosméticos Artesanales".ToUpper()).Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            //column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            //column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn((float)0.3);
                                    columns.RelativeColumn((float)0.7);
                                });

                                table.Header(header =>
                                {
                                    header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("DATOS GENERALES").Bold();
                                });

                                //Establecimiento
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1. ESTABLECIMIENTO".ToUpper());
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Nombre);
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.2 Ubicacion:");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Provincia");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Provincia?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Distrito");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Distrito?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Corregimiento");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Corregimiento?.Nombre ?? "");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(" Ubicación");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento?.Direccion);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.3 Teléfono");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Telefono));
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("1.4 Correo Electronico");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento?.Correo));
                                                               
                                table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3. Propietario artesano".ToUpper());
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3.1 Nombre");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperturaCosmetArtesanal?.DatosRepresentLegal?.Nombre);
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("3.2 Cédula");
                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperturaCosmetArtesanal?.DatosRepresentLegal?.Cedula);

                                //table.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("4. Productos que fabricarán (adjuntar listado si lo poseen)".ToUpper());
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("4.1 Tipo");
                                //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperFabricanteCosmetMed?.ProdFabrican?.ProductosDesc);

                            });
                           

                            if (inspection.InspAperturaCosmetArtesanal?.Documentacion?.LContenido?.Count > 0) {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Documentación".ToUpper())).Bold();
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header => {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("No.".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto para evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumplimiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperturaCosmetArtesanal.Documentacion.LContenido) {
                                        if (dat.IsHeader) {
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().ColumnSpan(4).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0) {
                                                foreach (var eva in dat.LEvaluacion) {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspAperturaCosmetArtesanal?.Locales?.LContenido?.Count > 0) {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Locales".ToUpper())).Bold();
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header => {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto para evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Cumplimiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperturaCosmetArtesanal.Locales.LContenido) {
                                        if (dat.IsHeader) {
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0) {
                                                foreach (var eva in dat.LEvaluacion) {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }
                            if (inspection.InspAperturaCosmetArtesanal?.AreaAlmacenamiento?.LContenido?.Count > 0) {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("Áreas de Almacenamiento".ToUpper())).Bold();
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)3);
                                    });
                                    table.Header(header => {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Punto para evaluar".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Materia Prima".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Material de Acondicionamiento".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Productos Terminado".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIoNes".ToUpper());
                                    });
                                    foreach (var dat in inspection.InspAperturaCosmetArtesanal.AreaAlmacenamiento.LContenido) {
                                        if (dat.IsHeader) {
                                            //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Numero);
                                            table.Cell().ColumnSpan(5).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo).Bold();
                                        }
                                        else {
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            if (dat.LEvaluacion?.Count > 0) {
                                                foreach (var eva in dat.LEvaluacion) {
                                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                }
                                            }
                                            else {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("");
                                            }
                                            table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                        }
                                    }
                                });
                            }


                            column.Item().PaddingVertical(5).AlignCenter().Padding(3).Text(string.Format("CRITERIO TÉCNICO")).Bold();
                            column.Item().AlignLeft().Text(string.Format("Una vez evaluado el cumplimiento de los requerimientos previstos en el Decreto Ejecutivo N° 875 del 18 de noviembre de 2021, que reglamenta la elaboración de productos cosméticos arsenales en la República de Panamá.  Inspectores Farmacéuticos de la Dirección Nacional de Farmacia y Drogas del Ministerio de Salud de Panamá concluyen que el establecimiento denominado {0}, ubicado en {1} {2} con los requisitos mínimos para la elaboración de productos cosméticos arsenales.", inspection.DatosEstablecimiento?.Nombre, inspection.DatosEstablecimiento?.Direccion, (inspection.DatosConclusiones.CumpleRequisitosMinOperacion ? "SÍ CUMPLE" : "NO CUMPLE")));
                            //0- Nombere, 1- Ubicacion, 2-Cumple 

                            column.Item().PaddingVertical(5).AlignLeft().Text(string.Format("Dado en la ciudad de Panamá a los {0} días del mes de {1} de {2}.", 
                                inspection.DatosConclusiones?.FechaFinalizacion?.Day, 
                                Helper.Helper.GetMonthNameByMonthNumber(int.Parse(inspection.DatosConclusiones?.FechaFinalizacion?.ToString("MM") ?? "01")), 
                                inspection.DatosConclusiones?.FechaFinalizacion?.Year.ToString() ?? ""));

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0) {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns => {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes) {
                                        table.Cell().Table(tbl => {
                                            tbl.ColumnsDefinition(columns => {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma)) {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            column.Item().Table(table => {
                                table.ColumnsDefinition(columns => {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();


                                if (!string.IsNullOrEmpty(inspection.InspAperturaCosmetArtesanal.DatosRepresentLegal?.Firma)) {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperturaCosmetArtesanal.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                //if (!string.IsNullOrEmpty(inspection.InspAperturaCosmetArtesanal.DatosRegente?.Firma)) {
                                //    //var bytes = Convert.FromBase64String(base64encodedstring);
                                //    //var contents = new StreamContent(new MemoryStream(bytes));
                                //    byte[] data = Convert.FromBase64String(inspection.InspAperturaCosmetArtesanal.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                //    MemoryStream memoryStream = new MemoryStream(data);
                                //    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                //}
                                //else {
                                //    table.Cell().AlignLeft().Padding(3).Text("");
                                //}
                                table.Cell().AlignLeft().Text("");


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspAperturaCosmetArtesanal.DatosRepresentLegal?.Nombre, inspection.InspAperturaCosmetArtesanal.DatosRepresentLegal?.Cedula, inspection.InspAperturaCosmetArtesanal.DatosRepresentLegal?.Cargo));
                                //table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspAperturaCosmetArtesanal.DatosRegente?.Nombre, inspection.InspAperturaCosmetArtesanal.DatosRegente?.Cedula, inspection.InspAperturaCosmetArtesanal.DatosRegente?.Cargo, inspection.InspAperturaCosmetArtesanal.DatosRegente?.NumRegistro));
                                table.Cell().AlignLeft().Text("");

                                table.Cell().AlignLeft().Padding(3).Text("");

                            });


                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table => {
                                table.ColumnsDefinition(columns => {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols => {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header => {
                                        header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols => {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header => {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold();
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                    tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                            column.Item().PaddingVertical(5).AlignTop().Table(table => {
                                table.ColumnsDefinition(columns => {
                                    columns.RelativeColumn();
                                });

                                table.Header(header => {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("Inconformidades o desviaciones detectadas".ToUpper()).Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                        });

                        page.Footer().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }

        //Acta de Apertura o Cambio de Ubicacion de Botiquin de Pueblo
        private async Task<Stream> GenerateAperturaCambioUbicacionBotiquin(AUD_InspeccionTB inspection)
        {
            try
            {
                //var inspection = DalService.Get<AUD_InspeccionTB>(InspectionId);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table => {
                            table.ColumnsDefinition(columns => {
                                columns.RelativeColumn(3);
                                columns.RelativeColumn(4);
                                columns.RelativeColumn(2);
                            });

                            table.Header(header => {
                                header.Cell().AlignMiddle().Image(path);
                                header.Cell().AlignLeft().AlignMiddle().Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS \r\nDepartamento de Auditoria de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos \r\nSECCIÓN DE INSPECCIONES\r\n".ToUpper());
                                header.Cell().AlignRight().AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                        });

                        page.Content().Column(column => {
                            column.Item().AlignCenter().Text("ACTA PARA LA VERIFICACIÓN DE LOS REQUISITOS ESTRUCTURALES DE APERTURA Y/O VIGILANCIA DE OPERACIÓN DE BOTIQUÍN DE PUEBLO").Bold();
                            column.Item().PaddingVertical(5).AlignLeft().Text(" ");

                            column.Item().AlignLeft().Text(string.Format("Hora de Inicio: {0}", inspection.FechaInicio.ToString("hh:mm tt")));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", inspection.FechaInicio.ToString("dd/MM/yyyy")));
                            column.Item().AlignLeft().Text(string.Format("No. Recibo: {0}", inspection.DatosEstablecimiento.ReciboPago));

                            column.Item().AlignLeft().Text(string.Format("Tipo de Inspección: {0}", DataModel.Helper.Helper.GetDescription(inspection.TipoActa)));
                            column.Item().AlignLeft().Text(string.Format("Tipo de Establecimiento: {0}", DataModel.Helper.Helper.GetDescription(inspection.Establecimiento?.TipoEstablecimiento ?? enumAUD_TipoEstablecimiento.None)));

                            if (inspection.DatosEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)0.3);
                                        columns.RelativeColumn((float)0.7);
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("GENERALIDADES DEL ESTABLECIMIENTO Y SOLICITANTE").Bold();
                                    });

                                    //Establecimiento
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("NOMBRE DEL ESTABLECIMIENTO");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Nombre);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Provincia?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Distrito?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Corregimiento?.Nombre ?? "");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosEstablecimiento.Direccion);
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.Telefono));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Número de Licencia de Operación");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.NumLicencia));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Vigente Desde");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.VigenteDesde?.ToString("dd/MM/yyyy") ?? ""));
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Vigente Hasta");
                                    table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0}", inspection.DatosEstablecimiento.VigenteHasta?.ToString("dd/MM/yyyy") ?? ""));

                                    if (inspection.InspAperCambUbicBotiquin.DatosRepresentLegal != null)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre del Representante Legal o Propietario");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.Nombre);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.Cedula);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.Email);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosSolicitante?.PaisResidencia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosSolicitante?.Provincia);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosSolicitante?.Distrito);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosSolicitante?.Corregimiento);
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                                        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosSolicitante?.Direccion);
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.TelefonoResid, inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.TelefonoMovil));
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Profesión");
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.Profesion);
                                    }

                                    table.Footer(footer =>
                                    {
                                        footer.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ley 66 de 10 de noviembre de 1947. Código Sanitario de la República de Panamá. (G.O. 10467 de 6 de diciembre de 1947). Artículo 200. Prohíbese ejercer conjuntamente las profesiones de médico-cirujano y farmacéutico. A partir de la aprobación de este código, ningún médico que ejerza la profesión podrá ser dueño por sí mismo o por interpuesta persona, accionista o tener participación comercial cualquiera en establecimientos en que se fabriquen, preparen o vendan medicinas y artículos de cualquier clase que se usen para la prevención o curación de enfermedades, corrección de defectos o para el diagnóstico");
                                    });
                                });

                            }

                            //if (inspection.InspAperCambUbicBotiquin.DatosRegente != null)
                            //{
                            //    column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            //    {
                            //        table.ColumnsDefinition(columns =>
                            //        {
                            //            columns.RelativeColumn((float)0.3);
                            //            columns.RelativeColumn((float)0.7);
                            //        });

                            //        table.Header(header =>
                            //        {
                            //            header.Cell().ColumnSpan(2).Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("DATOS SOBRE EL REGENTE FARMACÉUTICO DE LA EMPRESA").Bold();
                            //        });

                            //        //Establecimiento
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Nombre");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente.Nombre);
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Registro de Idoneidad");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente.NumRegistro);
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Cédula de Identidad Personal");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente.Cedula);
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Correo electrónico");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente.Email);
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Se encontraba presente al momento de la inspección?");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspAperCambUbicBotiquin.DatosRegente.PresenteEnInspeccion));
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("El Regente Farmacéutico realiza otras funciones del dentro de la empresa?");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(inspection.InspAperCambUbicBotiquin.DatosRegente.RealizaOtraFuncion));
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Horario declarado en la Licencia de Operación");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente.HorarioRegencia);
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Residencia");
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente?.PaisResidencia);
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Provincia");
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente?.Provincia);
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Distrito");
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente?.Distrito);
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Corregimiento");
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente?.Corregimiento);
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Ubicación");
                            //        //table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.InspAperCambUbicBotiquin.DatosRegente?.Ubicacion);
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("Teléfono / Celular");
                            //        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(string.Format("{0} / {1}", inspection.InspAperCambUbicBotiquin.DatosRegente.TelefonoOfic, inspection.InspAperCambUbicBotiquin.DatosRegente?.TelefonoMovil));

                            //    });

                            //}

                            if (inspection.InspAperCambUbicBotiquin.CondCaractEstablecimiento != null)
                            {
                                column.Item().PaddingVertical(5).AlignLeft().Text(" ");
                                column.Item().AlignLeft().Text(string.Format("CONDICIONES Y CARACTERÍSTICAS DEL ESTABLECIMIENTO".ToUpper())).Bold();
                                column.Item().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn((float)3);
                                        columns.RelativeColumn((float)1);
                                        columns.RelativeColumn((float)4);
                                    });
                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("PREGUNTA".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("EVALUACIÓN".ToUpper());
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIóN".ToUpper());
                                    });
                                    if (inspection.InspAperCambUbicBotiquin?.CondCaractEstablecimiento?.LContenido?.Count > 0)
                                    {
                                        foreach (var dat in inspection.InspAperCambUbicBotiquin.CondCaractEstablecimiento.LContenido)
                                        {
                                            if (dat.IsHeader)
                                            {
                                                table.Cell().ColumnSpan(3).Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                            }
                                            else
                                            {
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Titulo);
                                                if (dat.LEvaluacion?.Count > 0)
                                                {
                                                    foreach (var eva in dat.LEvaluacion)
                                                    {
                                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(DataModel.Helper.Helper.GetDescription(eva.Evaluacion));
                                                    }
                                                }
                                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(dat.Observaciones);
                                            }
                                        }

                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).AlignTop().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn();
                                });

                                table.Header(header =>
                                {
                                    header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("OBSERVACIONES GENERALES").Bold();
                                });

                                table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text(inspection.DatosConclusiones?.ObservacionesFinales);

                            });

                            column.Item().PaddingVertical(5).Text("OBSERVACIÓN:").Bold();
                            column.Item().Text("El Acta original se mantendrá en el expediente del establecimiento que permanece en la Dirección Nacional de Farmacia y Drogas y se hace entrega de una copia al firmante de esta acta, al finalizar la inspección").Bold();
                                  
                            if (inspection.DatosConclusiones != null)
                            {
                                column.Item().PaddingVertical(5).AlignTop().Table(table =>
                                {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn();
                                    });

                                    table.Header(header =>
                                    {
                                        header.Cell().Border(1).BorderColor(Colors.Black).DefaultTextStyle(cellTextStyle).Background("#011E56").AlignCenter().Padding(3).Text("SEGÚN CRITERIO TÉCNICO SE CONCLUYE QUE").Bold();
                                    });

                                    if (inspection.DatosConclusiones.CumpleRequisitosMinOperacion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }
                                    else
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("EL LOCAL NO CUMPLE ESTRUCTURALMENTE CON LOS REQUISITOS MÍNIMOS PARA OPERAR").Bold();
                                    }

                                    if (inspection.DatosConclusiones.ReprogramaInspeccion)
                                    {
                                        table.Cell().Border(1).BorderColor(Colors.Black).AlignLeft().Padding(3).Text("SE REPROGRAMA INSPECCIÓN AL ESTABLECIMIENTO").Bold();
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Esta Acta se levanta en presencia de los abajo firmantes\r\n"));
                            column.Item().Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                    columns.RelativeColumn(1);
                                });

                                table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Establecimiento:").Bold();
                                if (!string.IsNullOrEmpty(inspection.InspAperCambUbicBotiquin.DatosRepresentLegal?.Firma))
                                {
                                    //var bytes = Convert.FromBase64String(base64encodedstring);
                                    //var contents = new StreamContent(new MemoryStream(bytes));
                                    byte[] data = Convert.FromBase64String(inspection.InspAperCambUbicBotiquin.DatosRepresentLegal.Firma.Split("image/png;base64,")[1]);
                                    MemoryStream memoryStream = new MemoryStream(data);
                                    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitArea);
                                }
                                else
                                {
                                    table.Cell().AlignLeft().Padding(3).Text("");
                                }


                                //if (!string.IsNullOrEmpty(inspection.InspAperCambUbicBotiquin.DatosRegente?.Firma))
                                //{
                                //    //var bytes = Convert.FromBase64String(base64encodedstring);
                                //    //var contents = new StreamContent(new MemoryStream(bytes));
                                //    byte[] data = Convert.FromBase64String(inspection.InspAperCambUbicBotiquin.DatosRegente.Firma.Split("image/png;base64,")[1]);
                                //    MemoryStream memoryStream = new MemoryStream(data);
                                //    table.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                //}
                                //else
                                //{
                                //    table.Cell().AlignLeft().Padding(3).Text("");
                                //}
                                table.Cell().AlignLeft().Padding(3).Text("");


                                table.Cell().AlignLeft().Padding(3).Text("");

                                table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2}", inspection.InspAperCambUbicBotiquin.DatosRepresentLegal?.Nombre, inspection.InspAperCambUbicBotiquin.DatosRepresentLegal?.Cedula, inspection.InspAperCambUbicBotiquin.DatosRepresentLegal?.Cargo));
                                //table.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Cargo:{2} | Reg.:{3}", inspection.InspAperCambUbicBotiquin.DatosRegente?.Nombre, inspection.InspAperCambUbicBotiquin.DatosRegente?.Cedula, inspection.InspAperCambUbicBotiquin.DatosRegente?.Cargo, inspection.InspAperCambUbicBotiquin.DatosRegente?.NumRegistro));
                                table.Cell().AlignLeft().Padding(3).Text("");


                                table.Cell().AlignLeft().Padding(3).Text("");

                            });

                            column.Item().PaddingVertical(5).Text(" ").Bold();

                            if (inspection.ParticipantesDNFD?.LParticipantes?.Count > 0)
                            {
                                column.Item().Table(table => {
                                    table.ColumnsDefinition(columns =>
                                    {
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                        columns.RelativeColumn(1);
                                    });

                                    table.Cell().ColumnSpan(3).AlignLeft().Text("Por el Ministerio de Salud (DNFD):").Bold();

                                    foreach (var participant in inspection.ParticipantesDNFD.LParticipantes)
                                    {
                                        table.Cell().Table(tbl =>
                                        {
                                            tbl.ColumnsDefinition(columns =>
                                            {
                                                columns.RelativeColumn(1);
                                            });
                                            if (!string.IsNullOrEmpty(participant.Firma))
                                            {
                                                byte[] data = Convert.FromBase64String(participant.Firma.Split("image/png;base64,")[1]);
                                                MemoryStream memoryStream = new MemoryStream(data);
                                                tbl.Cell().AlignCenter().Image(memoryStream, ImageScaling.FitWidth);
                                            }
                                            tbl.Cell().AlignCenter().Text(string.Format("{0}\r\nCédula:{1} | Reg.:{2}", participant.NombreCompleto, participant.CedulaIdentificacion, participant.RegistroNumero));
                                        });
                                    }
                                });
                            }

                            column.Item().PaddingVertical(5).Text(string.Format("Hora de finalización de inspección: {0}", inspection.DatosConclusiones?.FechaFinalizacion?.ToString("dd/MM/yyyy hh:mm tt") ?? ""));

                            column.Item().PaddingVertical(10).Table(table =>
                            {
                                table.ColumnsDefinition(columns =>
                                {
                                    columns.RelativeColumn(4);
                                    columns.RelativeColumn(6);
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                    });
                                    tbl.Header(header =>
                                    {
                                        header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                                    });
                                    tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                                    tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                                    tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                                    tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                                    tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                                });

                                table.Cell().Table(tbl => {
                                    tbl.ColumnsDefinition(cols =>
                                    {
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                        cols.RelativeColumn();
                                    });

                                    tbl.Header(header =>
                                    {
                                        tbl.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold();
                                    });

                                    tbl.Cell().AlignLeft().Text("S. Inspecciones");
                                    tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                                    tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("S. Auditorías");
                                    tbl.Cell().AlignLeft().Text("512-9168/62");
                                    tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Veraguas");
                                    tbl.Cell().AlignLeft().Text("935-0316/18");
                                    tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Padding(3).Text("OR Chiriquí");
                                    tbl.Cell().AlignLeft().Text("774-7410");
                                    tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Colón");
                                    tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                                    tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                                    tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                                    tbl.Cell().AlignLeft().Text("504-2565");
                                    tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                                });

                            });

                        });

                        page.Footer().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                            });


                            table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                        });
                    });
                }).GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch { }
            return null;
        }


        ///////////////////////////
        ///

        public async Task<Stream> GenerateCorrespondencia(long Id)
        {
            try
            {
                var correspondencia = DalService.Get<AUD_CorrespondenciaTB>(Id);

                // code in your main method
                var byteArray = QuestPDF.Fluent.Document.Create(container =>
                {
                    container.Page(page =>
                    {
                        page.Size(PageSizes.Letter); 
                        page.Margin(5, Unit.Millimetre);
                        page.PageColor(Colors.White);
                        page.DefaultTextStyle(x => x.FontSize(8));

                        //page.DefaultTextStyle(x => x.Color("Black"));

                        var path = System.IO.Path.Combine(env.WebRootPath, "img", "pdf", "Header.png");

                        page.Header().Table(table =>
                        {
                            table.ColumnsDefinition(columns =>
                            {
                                columns.RelativeColumn();
                                columns.RelativeColumn();
                                columns.RelativeColumn();
                            });

                            table.Header(header =>
                            {
                                header.Cell().Image(path);
                                header.Cell().AlignCenter().Padding(3).Text("");
                                header.Cell().AlignCenter().Padding(3).Text("");
                                //header.Cell().AlignRight().Padding(3).AlignMiddle().Text(string.Format("Acta N°: {0}\r\nEstatus: {1}", inspection.NumActa, DataModel.Helper.Helper.GetDescription(inspection.StatusInspecciones)));
                            });

                            table.Cell().ColumnSpan(3).AlignLeft().Padding(3).Text("DIRECCIÓN NACIONAL DE FARMACIA Y DROGAS").Bold();
                            table.Cell().ColumnSpan(3).AlignCenter().Padding(3).Text("Departamento de Auditorías de Calidad a Establecimientos Farmacéuticos y No Farmacéuticos");
                            //table.Cell().ColumnSpan(3).AlignCenter().Padding(3).Text("Guía para las Buenas Prácticas de Almacenamiento, Distribución y Transporte de Medicamentos y Otros Productos para la Salud Humana".ToUpper()).Bold();
                        });

                        page.Content().PaddingVertical(20).Column(column =>
                        {
                            column.Item().AlignLeft().Text(string.Format("Para: {0} \r\n{1}", correspondencia.NombreDirigido, correspondencia.DptoSeccion));
                            column.Item().AlignLeft().Text(string.Format("Fecha: {0}", DateTime.Now.ToString("dd/MM/yyyy")));

                            
                            column.Item().PaddingVertical(10).AlignLeft().Padding(3).Text(string.Format(" ".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(string.Format("Asunto:".ToUpper())).Bold();
                            column.Item().AlignLeft().Text(correspondencia.Asunto);
                            
                        });

                        page.Footer().Column(column =>
                        {
                            column.Item().AlignLeft().Text("De: ______________________________________");
                            column.Item().AlignLeft().Text("Ana Belén Gonzáles");
                            column.Item().AlignLeft().Text("Jefa del Dpto. Auditorías de Calidad a \r\nEstablecimientos Farmacéuticos y NF");

                        });

                    });
                })
                  .GeneratePdf();

                Stream stream = new MemoryStream(byteArray);

                return stream;
            }
            catch (Exception ex)
            { }
            return null;
        }

    }

    public class FooterWithUniqueLastPage : QuestPDF.Infrastructure.IDynamicComponent<int>
    {
        public int State { get; set; }
        public AUD_InspeccionTB Model { get; set; }

        public FooterWithUniqueLastPage(AUD_InspeccionTB Model)
        {
            this.Model = Model;
        }

        public DynamicComponentComposeResult Compose(QuestPDF.Elements.DynamicContext context)
        {
            var content = context.CreateElement(element =>
            {                
                //if (context.PageNumber == context.TotalPages)
                {
                    element.AlignBottom().Table(table =>
                    {
                        table.ColumnsDefinition(columns =>
                        {
                            columns.RelativeColumn(6);
                            columns.RelativeColumn(4);
                        });

                        table.Cell().Table(tbl =>
                        {
                            tbl.ColumnsDefinition(cols =>
                            {
                                cols.RelativeColumn();
                            });
                            tbl.Header(header =>
                            {
                                header.Cell().AlignLeft().Text("Fundamento Legal:").Bold();
                            });
                            tbl.Cell().AlignLeft().Text("Ley 66 de 10 de noviembre de 1947");
                            tbl.Cell().AlignLeft().Text("Ley 1 de 10 de enero de 2001");
                            tbl.Cell().AlignLeft().Text("Ley 17 de 12 de septiembre de 2014");
                            tbl.Cell().AlignLeft().Text("Ley 24 de 29 de enero de 1963");
                            tbl.Cell().AlignLeft().Text("Decreto Ejecutivo 115 de 16 de agosto de 2022");
                        });

                        table.Cell().Table(tbl =>
                        {
                            tbl.ColumnsDefinition(cols =>
                            {
                                cols.RelativeColumn();
                                cols.RelativeColumn();
                                cols.RelativeColumn();
                            });

                            tbl.Header(header =>
                            {
                                header.Cell().ColumnSpan(3).AlignLeft().Text("Contáctenos:").Bold();
                            });

                            tbl.Cell().AlignLeft().Text("S. Inspecciones");
                            tbl.Cell().AlignLeft().Text("512-9168/62 (Ext. 1126)");
                            tbl.Cell().AlignLeft().Text("inspeccionesfyd@minsa.gob.pa");

                            tbl.Cell().AlignLeft().Text("S. Auditorías");
                            tbl.Cell().AlignLeft().Text("512-9168/62");
                            tbl.Cell().AlignLeft().Text("auditoriafyd@minsa.gob.pa");

                            tbl.Cell().AlignLeft().Text("OR Veraguas");
                            tbl.Cell().AlignLeft().Text("935-0316/18");
                            tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");

                            tbl.Cell().AlignLeft().Text("orvdnfd@minsa.gob.pa");
                            tbl.Cell().AlignLeft().Text("774-7410");
                            tbl.Cell().AlignLeft().Text("fydchiriqui@minsa.gob.pa");

                            tbl.Cell().AlignLeft().Text("OR Colón");
                            tbl.Cell().AlignLeft().Text("475-2060 Ext. 5021");
                            tbl.Cell().AlignLeft().Text("mbramwell@minsa.gob.pa");

                            tbl.Cell().AlignLeft().Text("OR Panamá Pacífico");
                            tbl.Cell().AlignLeft().Text("504-2565");
                            tbl.Cell().AlignLeft().Text("rlquiros@minsa.gob.pa");
                        });

                        table.Cell().ColumnSpan(2).AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));
                    });

                    //element.Table(table =>
                    //{
                    //    table.ColumnsDefinition(columns =>
                    //    {
                    //        columns.RelativeColumn();
                    //    });
                    //    table.Cell().AlignRight().Padding(3).AlignBottom().Text(string.Format("Confeccionado: {0}", DateTime.Now.ToString("dd/MM/yyyy")));

                    //    //// layer below main content

                    //    //layers
                    //    //.Layer()
                    //    //.AlignBottom()
                    //    //.Image(datafooter, ImageScaling.FitWidth);

                    //    //layers
                    //    //.PrimaryLayer()
                    //    //.ExtendHorizontal()
                    //    //.AlignBottom()
                    //    //.Column(column =>
                    //    //{
                    //    //    column.Item().AlignBottom().Row(row =>
                    //    //    {
                    //    //        row.RelativeItem(55).AlignBottom().PaddingBottom(5).Component(new BankInfoComponent(Model.BankInfo));
                    //    //        row.RelativeItem(40).AlignBottom().PaddingBottom(25).PaddingLeft(30).Component(new TotalComponent(Model));
                    //    //    });
                    //    //});

                    //    //layers
                    //    //    .Layer()
                    //    //    .PaddingBottom(2)
                    //    //    .PaddingRight(10)
                    //    //    .AlignRight()
                    //    //    .AlignBottom()
                    //    //    .Text(string.Format("Total: {0}", Model.Total.ToString("C2"))).FontSize(24)
                    //    //    .Bold().FontColor(Colors.White);
                    //});

                }
            });

            return new DynamicComponentComposeResult
            {
                Content = content,
                HasMoreContent = false
            };
        }
    }


}
